<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Scala Library Dependencies :: The Mill JVM Build Tool</title>
    <link rel="canonical" href="https://mill-build.org/mill/0.12.1/scalalib/dependencies.html" />
    <link rel="prev" href="module-config.html" />
    <link rel="next" href="testing.html" />
    <meta name="generator" content="Antora 3.1.9" />
    <link rel="stylesheet" href="../../../_/css/site.css" />
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1C582ZJR85"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-1C582ZJR85')</script>
<link rel="icon" href="../../../_/favicon.png" type="image/x-icon" />
  
  </head><body class="article">
  
<header class="header">
  <nav class="navbar">
    <div class="navbar-brand">
      <!-- TODO: add mill icon -->
      <a class="navbar-item" href="https://mill-build.org"><img src="../../../_/logo-white.svg" height="20" /> The Mill JVM Build Tool</a>
      <div class="navbar-item search">
        <input id="search-input" type="text" placeholder="Search the docs" />
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill">Source Code (GitHub)</a>
        <a class="navbar-item" href="https://mill-build.org/api/latest/index.html">API</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/issues">Issues</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/discussions">Discuss</a>


            <!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#"></a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
        -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mill" data-version="0.12.1">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../javalib/intro.html">Building Java Projects with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javalib/installation-ide.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javalib/builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javalib/module-config.html">Java Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../javalib/dependencies.html">Java Library Dependencies</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/testing.html">Testing Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/linting.html">Linting Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/publishing.html">Publishing Java Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/build-examples.html">Java Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/web-examples.html">Java Web Project Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../javalib/android-examples.html">(Experimental) Android Builds</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="intro.html">Building Scala Projects with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="installation-ide.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="module-config.html">Scala Module Configuration</a>
  </li>

  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="dependencies.html">Scala Library Dependencies</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="testing.html">Testing Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="linting.html">Linting Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="publishing.html">Publishing Scala Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="build-examples.html">Scala Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="web-examples.html">Scala Web Project Examples</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../kotlinlib/intro.html">(Experimental) Kotlin with Mill</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../kotlinlib/installation-ide.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../kotlinlib/builtin-commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../kotlinlib/module-config.html">Kotlin Module Configuration</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../kotlinlib/dependencies.html">Kotlin Library Dependencies</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/testing.html">Testing Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/linting.html">Linting Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/publishing.html">Publishing Kotlin Projects</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/build-examples.html">Kotlin Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/web-examples.html">Kotlin Web Project Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../kotlinlib/android-examples.html">(Experimental) Android Builds</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Build Tool Comparisons</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../comparisons/maven.html">Case Study: Mill vs Maven</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../comparisons/gradle.html">Case Study: Mill vs Gradle</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../comparisons/sbt.html">Case Study: Mill vs SBT</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill Fundamentals</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fundamentals/tasks.html">Tasks</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fundamentals/modules.html">Modules</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fundamentals/out-dir.html">The Output Directory</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fundamentals/query-syntax.html">Task Query Syntax</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../fundamentals/library-deps.html">Library Dependencies in Mill</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../fundamentals/cross-builds.html">Cross Builds</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../fundamentals/bundled-libraries.html">Bundled Libraries</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Extending Mill</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../extending/import-ivy-plugins.html">Import Libraries and Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../extending/contrib-plugins.html">Contrib Plugins</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../contrib/artifactory.html">Artifactory</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../contrib/bintray.html">Bintray</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../contrib/bloop.html">Bloop</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="../contrib/buildinfo.html">BuildInfo</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/codeartifact.html">Codeartifact</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/docker.html">Docker</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/flyway.html">Flyway</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/gitlab.html">Gitlab</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/jmh.html">JMH</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/playlib.html">Play Framework</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/proguard.html">Proguard</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/scalapblib.html">ScalaPB</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/scoverage.html">Scoverage</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/sonatypecentral.html">Sonatype Central</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/testng.html">TestNG</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/twirllib.html">Twirl</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="../contrib/versionfile.html">Version file</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../extending/thirdparty-plugins.html">Third-Party Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../extending/running-jvm-code.html">Running Dynamic JVM Code</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../extending/writing-plugins.html">Writing Mill Plugins</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../extending/meta-build.html">The Mill Meta-Build</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../extending/new-language.html">Support for New Languages</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill In Depth</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../depth/large-builds.html">Large Builds and Monorepos</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../depth/sandboxing.html">Mill Sandboxing</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../depth/evaluation-model.html">The Mill Evaluation Model</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../depth/design-principles.html">Mill Design Principles</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="../depth/why-scala.html">Why does Mill use Scala?</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://mill-build.org/api/latest/mill/index.html">Mill Scaladoc</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../reference/changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Mill Documentation</span>
    <span class="version">0.12.1</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Mill Documentation</a></div>
      <ul class="versions">
        <li class="version">
          <a href="../../index.html">0.12.1-14-30c005</a>
        </li>
        <li class="version is-current is-latest">
          <a href="../index.html">0.12.1</a>
        </li>
        <li class="version">
          <a href="../../0.11.12/index.html">0.11.12</a>
        </li>
        <li class="version">
          <a href="../../0.10.15/index.html">0.10.15</a>
        </li>
        <li class="version">
          <a href="../../0.9.12/index.html">0.9.12</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Mill Documentation</a></li>
    <li><a href="intro.html">Building Scala Projects with Mill</a></li>
    <li><a href="dependencies.html">Scala Library Dependencies</a></li>
  </ul>
</nav>
<div class="edit-this-page"><a href="https://github.com/com-lihaoyi/mill/edit/main/out/docs/oldDocSources.dest/0.12.1/out/docs/source.dest/modules/ROOT/pages/scalalib/dependencies.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Scala Library Dependencies</h1>
<div id="preamble">
<div class="sectionbody">
<script>
gtag('config', 'AW-16649289906');

document.addEventListener('DOMContentLoaded', function() {
const links = document.querySelectorAll('a');
  links.forEach(link => {
    if (link.textContent.trim().toLowerCase() === 'download') {
      link.addEventListener('click', function(event) {
        console.log("download link clicked")
        gtag('event', 'conversion', {'send_to': 'AW-16649289906/rsphCKfVq8QZELKBgIM-'});
      });
    }
  });
});
</script>
<div class="paragraph">
<p>This page goes into more detail about configuring third party dependencies
for <code>ScalaModule</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_ivy_dependencies"><a class="anchor" href="#_adding_ivy_dependencies"></a>Adding Ivy Dependencies</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.1/0.12.1-example-scalalib-dependencies-1-ivy-deps.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.1//example/scalalib/dependencies/1-ivy-deps">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, scalalib._

object `package` extends RootModule with ScalaModule {
  def scalaVersion = &quot;2.12.17&quot;
  def ivyDeps = Agg(
    ivy&quot;com.lihaoyi::upickle:3.1.0&quot;,
    ivy&quot;com.lihaoyi::pprint:0.8.1&quot;,
    ivy&quot;${scalaOrganization()}:scala-reflect:${scalaVersion()}&quot;
  )
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define the <code>ivyDeps</code> field to add ivy dependencies to your module,
named after the <a href="https://ant.apache.org/ivy/history/latest-milestone/settings/resolvers.html">Ivy Dependency Resolver</a>
and JVM package repository format. The <code>Agg</code> factory function constructs an
<code>Agg[Dep]</code> collection, which is a collection of `Dep`s without duplicates,
a type common in Mill builds.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Single <code>:</code> syntax (e.g. <code>&quot;ivy&quot;org.testng:testng:6.11&quot;</code>) defines Java
dependencies</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Double <code>::</code> syntax (e.g. <code>ivy&quot;com.lihaoyi::upickle:0.5.1&quot;</code>) defines Scala
dependencies</p>
</li>
<li>
<p>Triple <code>:::</code> syntax (e.g. <code>ivy&quot;org.scalamacros:::paradise:2.1.1&quot;</code>) defines</p>
</li>
<li>
<p>Triple <code>:::</code> syntax (e.g. <code>ivy&quot;org.scalamacros:::paradise:2.1.1&quot;</code>) defines
dependencies cross-published against the full Scala version e.g. <code>2.12.4</code>
instead of just <code>2.12</code>. These are typically Scala compiler plugins or
similar.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To select the test-jars from a dependency use the following syntax:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ivy&quot;org.apache.spark::spark-sql:2.4.0;classifier=tests</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please consult the <a href="../fundamentals/library-deps.html" class="xref page">Library Dependencies in Mill</a> section for more details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run i am cow
pretty-printed using PPrint: Array(&quot;i&quot;, &quot;am&quot;, &quot;cow&quot;)
serialized using uPickle: [&quot;i&quot;,&quot;am&quot;,&quot;cow&quot;]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_runtime_and_compile_time_dependencies"><a class="anchor" href="#_runtime_and_compile_time_dependencies"></a>Runtime and Compile-time Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to use additional dependencies at runtime or override
dependencies and their versions at runtime, you can do so with
<code>runIvyDeps</code>.</p>
</div>
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.1/0.12.1-example-scalalib-dependencies-2-run-compile-deps.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.1//example/scalalib/dependencies/2-run-compile-deps">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, scalalib._

object foo extends ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;
  def moduleDeps = Seq(bar)
  def runIvyDeps = Agg(
    ivy&quot;javax.servlet:servlet-api:2.5&quot;,
    ivy&quot;org.eclipse.jetty:jetty-server:9.4.42.v20210604&quot;,
    ivy&quot;org.eclipse.jetty:jetty-servlet:9.4.42.v20210604&quot;
  )
  def mainClass = Some(&quot;bar.Bar&quot;)
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also declare compile-time-only dependencies with <code>compileIvyDeps</code>.
These are present in the compile classpath, but will not propagate to the
transitive dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">object bar extends ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;
  def compileIvyDeps = Agg(
    ivy&quot;javax.servlet:servlet-api:2.5&quot;,
    ivy&quot;org.eclipse.jetty:jetty-server:9.4.42.v20210604&quot;,
    ivy&quot;org.eclipse.jetty:jetty-servlet:9.4.42.v20210604&quot;
  )
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Typically, Mill assumes that a module with compile-time dependencies will
only be run after someone includes the equivalent run-time dependencies in
a later build step. e.g. in the case above, <code>bar</code> defines the compile-time
dependencies, and <code>foo</code> then depends on <code>bar</code> and includes the runtime
dependencies. That is why we can run <code>foo</code> as show below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.runBackground

&gt; curl http://localhost:8079
&lt;html&gt;&lt;body&gt;Hello World!&lt;/body&gt;&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Compile-time dependencies are translated to <code>provided</code>-scoped
dependencies when publish to Maven or Ivy-Repositories.
</td>
</tr>
</tbody></table>
</div>
<div class="paragraph">
<p>Both <code>compileIvyDeps</code> and <code>runIvyDeps</code> are non-transitive: a module does not
automatically aggregate them from its upstream dependencies. They must be
defined in every module that they are required in, either explicitly or via
a <code>trait</code> that the module inherits from.</p>
</div>
<div class="sect2">
<h3 id="_keeping_up_to_date_with_scala_steward"><a class="anchor" href="#_keeping_up_to_date_with_scala_steward"></a>Keeping up-to-date with Scala Steward</h3>
<div class="paragraph">
<p>It’s always a good idea to keep your dependencies up-to-date.</p>
</div>
<div class="paragraph">
<p>If your project is hosted on GitHub, GitLab, or Bitbucket, you can use
<a href="https://github.com/scala-steward-org/scala-steward">Scala Steward</a> to
automatically open a pull request to update your dependencies whenever
there is a newer version available.</p>
</div>
<div class="admonitionblock tip">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Scala Steward can also keep your
<a href="installation-ide.html#_automatic_mill_updates" class="xref page">Mill version up-to-date</a>.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unmanaged_jars"><a class="anchor" href="#_unmanaged_jars"></a>Unmanaged Jars</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In most scenarios you should rely on <code>ivyDeps</code>/<code>moduleDeps</code> and let Mill manage
the compilation/downloading/caching of classpath jars for you, as Mill will
automatically pull in transitive dependencies which are generally needed for things
to work, and avoids including different versions of the same classfiles or jar which
can cause confusion. But in the rare case you receive a jar or folder-full-of-classfiles
from somewhere and need to include it in your project, <code>unmanagedClasspath</code> is the
way to do it.</p>
</div>
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.1/0.12.1-example-scalalib-dependencies-3-unmanaged-jars.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.1//example/scalalib/dependencies/3-unmanaged-jars">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, scalalib._

object `package` extends RootModule with ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;
  def unmanagedClasspath = Task {
    if (!os.exists(millSourcePath / &quot;lib&quot;)) Agg()
    else Agg.from(os.list(millSourcePath / &quot;lib&quot;).map(PathRef(_)))
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can override <code>unmanagedClasspath</code> to point it at any jars you place on the
filesystem, e.g. in the above snippet any jars that happen to live in the
<code>lib/</code> folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run '{&quot;name&quot;:&quot;John&quot;,&quot;age&quot;:30}'     # mac/linux
Key: name, Value: John
Key: age, Value: 30</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_downloading_unmanaged_jars"><a class="anchor" href="#_downloading_unmanaged_jars"></a>Downloading Unmanaged Jars</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can also override <code>unmanagedClasspath</code> to point it at jars that you want to
download from arbitrary URLs.
<code>requests.get</code> comes from the <a href="https://github.com/com-lihaoyi/requests-scala">Requests-Scala</a>
library, one of Mill’s <a href="../fundamentals/bundled-libraries.html" class="xref page">Bundled Libraries</a>.</p>
</div>
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.1/0.12.1-example-scalalib-dependencies-4-downloading-unmanaged-jars.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.1//example/scalalib/dependencies/4-downloading-unmanaged-jars">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, scalalib._

object `package` extends RootModule with ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;
  def unmanagedClasspath = Task {
    os.write(
      Task.dest / &quot;fastjavaio.jar&quot;,
      requests.get.stream(
        &quot;https://github.com/williamfiset/FastJavaIO/releases/download/1.1/fastjavaio.jar&quot;
      )
    )
    Agg(PathRef(Task.dest / &quot;fastjavaio.jar&quot;))
  }
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run &quot;textfile.txt&quot; # mac/linux
I am cow
hear me moo
I weigh twice as much as you</code></pre>
</div>
</div>
<div class="paragraph">
<p>Tasks like <code>unmanagedClasspath</code> are
cached, so your jar is downloaded only once and re-used indefinitely after that.
This is usually not a problem, because usually URLs follow the rule that
<a href="https://www.w3.org/Provider/Style/URI">Cool URIs don’t change</a>, and so jars
downloaded from the same URL will always contain the same contents.</p>
</div>
<div class="admonitionblock note">
<table>
<tbody><tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
An unmanaged jar downloaded via <code>requests.get</code> is still unmanaged: even
though you downloaded it from somewhere, it <code>requests.get</code> does not know how to
pull in third party dependencies or de-duplicate different versions on the classpath
All the same caveats you need to worry about when dealing with <a href="#_unmanaged_jars">unmanaged jars</a>
apply here as well.
</td>
</tr>
</tbody></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_repository_config"><a class="anchor" href="#_repository_config"></a>Repository Config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, dependencies are resolved from <a href="https://central.sonatype.com/">Maven Central</a>,
the standard package repository for JVM languages like Java, Kotlin, or Scala. You
can also add your own resolvers by overriding the <code>repositoriesTask</code> task in the module:</p>
</div>
<div class="listingblock">
<div class="title">build.mill (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.12.1/0.12.1-example-scalalib-dependencies-5-repository-config.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.12.1//example/scalalib/dependencies/5-repository-config">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">package build
import mill._, scalalib._
import mill.define.ModuleRef
import coursier.maven.MavenRepository

val sonatypeReleases = Seq(
  MavenRepository(&quot;https://oss.sonatype.org/content/repositories/releases&quot;)
)

object foo extends ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;

  def ivyDeps = Agg(
    ivy&quot;com.lihaoyi::scalatags:0.12.0&quot;,
    ivy&quot;com.lihaoyi::mainargs:0.6.2&quot;
  )

  def repositoriesTask = Task.Anon {
    super.repositoriesTask() ++ sonatypeReleases
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mill uses the <a href="https://get-coursier.io/">Coursier</a> dependency resolver, and reads
Coursier config files automatically.</p>
</div>
<div class="paragraph">
<p>You can configure Coursier to use an alternate download location for Maven Central
artifacts via a <code>mirror.properties</code> file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">central.from=https://repo1.maven.org/maven2
central.to=http://example.com:8080/nexus/content/groups/public</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note theses default config file locatations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linux: <code>~/.config/coursier/mirror.properties</code></p>
</li>
<li>
<p>MacOS: <code>~/Library/Preferences/Coursier/mirror.properties</code></p>
</li>
<li>
<p>Windows: <code>C:\Users\&lt;user_name&gt;\AppData\Roaming\Coursier\config\mirror.properties</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also set the environment variable <code>COURSIER_MIRRORS</code> or the jvm property <code>coursier.mirrors</code> to specify config file location.</p>
</div>
<div class="paragraph">
<p>To add custom resolvers to the initial bootstrap of the build, you can create a
custom <code>ZincWorkerModule</code> (named after the <a href="https://github.com/sbt/zinc">Zinc Incremental compiler</a>
used to compile the <code>build.mill</code> files) and override the <code>zincWorker</code> method in your
<code>ScalaModule</code> by pointing it to that custom object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">object CustomZincWorkerModule extends ZincWorkerModule with CoursierModule {
  def repositoriesTask = Task.Anon { super.repositoriesTask() ++ sonatypeReleases }
}

object bar extends ScalaModule {
  def scalaVersion = &quot;2.13.8&quot;
  def zincWorker = ModuleRef(CustomZincWorkerModule)
  // ... rest of your build definitions

  def repositoriesTask = Task.Anon {super.repositoriesTask() ++ sonatypeReleases}
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.run --text hello

&gt; ./mill bar.compile</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_working_without_access_to_maven_central"><a class="anchor" href="#_working_without_access_to_maven_central"></a>Working without access to Maven Central</h3>
<div class="paragraph">
<p>Under some circumstances (e.g. corporate firewalls), you may not have access maven central. The typical symptom will be error messages which look like this;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1 tasks failed
mill.scalalib.ZincWorkerModule.classpath
Resolution failed for 1 modules:
--------------------------------------------
  com.lihaoyi:mill-scalalib-worker_2.13:0.11.1
        not found: C:\Users\partens\.ivy2\local\com.lihaoyi\mill-scalalib-worker_2.13\0.11.1\ivys\ivy.xml
        download error: Caught java.io.IOException (Server returned HTTP response code: 503 for URL: https://repo1.maven.org/maven2/com/lihaoyi/mill-scalalib-worker_2.13/0.11.1/mill-scalalib-worker_2.13-0.11.1.pom) while downloading https://repo1.maven.org/maven2/com/lihaoyi/mill-scalalib-worker_2.13/0.11.1/mill-scalalib-worker_2.13-0.11.1.pom</pre>
</div>
</div>
<div class="paragraph">
<p>It is expected that basic commands (e.g. clean) will not work, as Mill saying it is unable to resolve it’s own, fundamental, dependencies. Under such circumstances, you will normally have access to some proxy, or other corporate repository which resolves maven artifacts. The strategy is simply to tell mill to use that instead.</p>
</div>
<div class="paragraph">
<p>The idea is to set an environment variable COURSIER_REPOSITORIES (see coursier docs). The below command should pass the environment variable to the <code>mill</code> command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> COURSIER_REPOSITORIES=https://packages.corp.com/artifactory/maven/ mill resolve _</pre>
</div>
</div>
<div class="paragraph">
<p>If you are using millw, a more permanent solution could be to set the environment variable at the top of the millw script, or as a user environment variable etc.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="module-config.html">Scala Module Configuration</a></span>
  <span class="next"><a href="testing.html">Testing Scala Projects</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async="async" src="../../../_/js/vendor/highlight.js"></script>
<script src="../../../_/js/vendor/lunr.js"></script>
<script src="../../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../../.." data-snippet-length="100" data-stylesheet="../../../_/css/search.css"></script>
<script async="async" src="../../../search-index.js"></script>
  
</body></html>