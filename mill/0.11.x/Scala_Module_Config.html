<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Scala Module Configuration :: The Mill Build Tool</title>
    <link rel="canonical" href="https://mill-build.org/mill/scalalib/module-config.html">
    <link rel="prev" href="Scala_Build_Examples.html">
    <link rel="next" href="Scala_Web_Build_Examples.html">
    <meta name="generator" content="Antora 3.1.9">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-1C582ZJR85"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-1C582ZJR85')</script>
<link rel="icon" href="../../_/favicon.png" type="image/x-icon">
  </head>
  <body class="article">
<header class="header">
  <style>
  /* auto-hyphenation is super ugly */
  *{
    hyphens: manual !important;
  }

  /* Reduce font size from 17px to something reasonable */
  .doc {
   font-size: 16px !important;
  }
  .doc pre {
   font-size: 14px !important;
  }
  /* Shrink unreasonably large top bar */
  nav.navbar{
    height: 2.5rem;
  }
  body.article{
    padding-top: 2.5rem;
  }
  div.nav-container{
    top: 2.5rem;
  }
  div.toolbar{
    top: 2.5rem;
  }
  aside.nav{
    top: 2.5rem;
    height: calc(100vh - 2.5rem);
  }
  </style>
  <script>
  gtag('config', 'AW-16649289906');

  document.addEventListener('DOMContentLoaded', function() {
  const links = document.querySelectorAll('a');
    links.forEach(link => {
      if (link.textContent.trim().toLowerCase() === 'download') {
        link.addEventListener('click', function(event) {
          console.log("download link clicked")
          gtag('event', 'conversion', {'send_to': 'AW-16649289906/rsphCKfVq8QZELKBgIM-'});
        });
      }
    });
  });
  </script>
  <nav class="navbar">
    <div class="navbar-brand">
      <!-- TODO: add mill icon -->
      <a class="navbar-item" href="https://mill-build.org"><img src="../../_/logo-white.svg" height="20" />&nbsp;The Mill Build Tool</a>
      <div class="navbar-item search">
        <input id="search-input" type="text" placeholder="Search the docs">
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill">GitHub</a>
        <a class="navbar-item" href="https://mill-build.org/blog/index.html">Blog</a>
        <a class="navbar-item" href="https://mill-build.org/api/latest/index.html">API</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/issues">Issues</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/discussions">Discuss</a>


            <!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#"></a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
        -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="mill" data-version="0.11.x">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Java Quick Start</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Java_Intro_to_Mill.html">Introduction to Mill for Java</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Java_Installation_IDE_Support.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Java_Builtin_Commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Java_Build_Examples.html">Java Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Java_Module_Config.html">Java Module Configuration</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Java_Web_Build_Examples.html">Java Web Build Examples</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Java_Case_Study_Netty.html">Java Case Study: Netty</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Scala Quick Start</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Scala_Intro_to_Mill.html">Introduction to Mill for Scala</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Scala_Installation_IDE_Support.html">Installation and IDE Support</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Scala_Builtin_Commands.html">Built-in Commands</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Scala_Build_Examples.html">Scala Build Examples</a>
  </li>

  <li class="nav-item is-current-page is-active" data-depth="1">
    <a class="nav-link" href="Scala_Module_Config.html">Scala Module Configuration</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Scala_Web_Build_Examples.html">Scala Web Build Examples</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill In Depth</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Library_Dependencies.html">Library Dependencies in Mill</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Out_Dir.html">The Output Directory</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Tasks.html">Tasks</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Modules.html">Modules</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Cross_Builds.html">Cross Builds</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Target_Query_Syntax.html">Target Query Syntax</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Extending_Mill.html">Extending Mill</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="The_Mill_Evaluation_Model.html">The Mill Evaluation Model</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Mill Plugins</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Using_Plugins.html">Using Plugins</a>
  </li>

  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="Contrib_Plugins.html">Contrib Plugins</a>
<ul class="nav-list">

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contrib/artifactory.html">Artifactory</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contrib/bintray.html">Bintray</a>
  </li>

  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="contrib/bloop.html">Bloop</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/buildinfo.html">BuildInfo</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="Plugin_BSP.html">BSP - Build Server Protocol</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/codeartifact.html">Codeartifact</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/docker.html">Docker</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/flyway.html">Flyway</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/gitlab.html">Gitlab</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/jmh.html">JMH</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/playlib.html">Play Framework</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/proguard.html">Proguard</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/scalapblib.html">ScalaPB</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/scoverage.html">Scoverage</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/testng.html">TestNG</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/twirllib.html">Twirl</a>
  </li>

  <li class="nav-item is-active" data-depth="2">
    <a class="nav-link" href="contrib/versionfile.html">Version file</a>
  </li>
</ul>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Thirdparty_Plugins.html">Third-Party Plugins</a>
  </li>
</ul>
  </li>

  <li class="nav-item is-active" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Reference</span>
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="Mill_Design_Principles.html">Mill Design Principles</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="External_References.html">External References</a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="https://mill-build.org/api/latest/mill/index.html">Mill Scaladoc</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="Changelog.html">Changelog</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Mill Documentation</span>
    <span class="version">0.11.13</span>
  </div>
  <ul class="components">
    <li class="component is-current">
      <div class="title"><a href="../index.html">Mill Documentation</a></div>
      <ul class="versions">
        <li class="version">
          <a href="../main-branch/index.html">main-branch</a>
        </li>
        <li class="version">
          <a href="../dev-1.0.0-RC3-13-c691ec/index.html">dev-1.0.0-RC3-13-c691ec</a>
        </li>
        <li class="version is-latest">
          <a href="../index.html">0.12.14</a>
        </li>
        <li class="version is-current">
          <a href="index.html">0.11.13</a>
        </li>
        <li class="version">
          <a href="../0.10.15/index.html">0.10.15</a>
        </li>
        <li class="version">
          <a href="../0.9.12/index.html">0.9.12</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <div class="title"><a href="../../blog/index.html">The Mill Build Engineering Blog</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">

<div class="toolbar" role="navigation" style="position: fixed; top: 2.5rem; height: 2rem; left: 0px;">
<button class="nav-toggle"></button>
</div>
<div class="toolbar" style="position: fixed; top: 2.5rem; height: 1.5rem; right: 0px; ">
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Scala Module Configuration</h1>
<div id="preamble">
<div class="sectionbody">
<script>
gtag('config', 'AW-16649289906');
</script>
<div class="paragraph">
<p>This page goes into more detail about the various configuration options
for <code>ScalaModule</code>.</p>
</div>
<div class="paragraph">
<p>Many of the APIs covered here are listed in the Scaladoc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://mill-build.org/api/latest/mill/scalalib/ScalaModule.html">mill.scalalib.ScalaModule</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_compilation_execution_flags"><a class="anchor" href="#_compilation_execution_flags"></a>Compilation &amp; Execution Flags</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-1-compilation-execution-flags.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/1-compilation-execution-flags">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule{
  def scalaVersion = "2.13.8"
  def scalacOptions = Seq("-Ydelambdafy:inline")
  def forkArgs = Seq("-Xmx4g", "-Dmy.jvm.property=hello")
  def forkEnv = Map("MY_ENV_VAR" -&gt; "WORLD")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can pass flags to the Scala compiler via <code>scalacOptions</code>.</p>
</div>
<div class="paragraph">
<p>By default,
<code>run</code> runs the compiled code in a subprocess, and you can pass in JVM flags
via <code>forkArgs</code> or environment-variables via <code>forkEnv</code>.</p>
</div>
<div class="paragraph">
<p>You can also run your code via</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mill foo.runLocal</code></pre>
</div>
</div>
<div class="paragraph">
<p>Which runs it in-process within an isolated classloader. This may be faster
since you avoid the JVM startup, but does not support <code>forkArgs</code> or <code>forkEnv</code>.</p>
</div>
<div class="paragraph">
<p>If you want to pass main-method arguments to <code>run</code> or <code>runLocal</code>, simply pass
them after the <code>foo.run</code>/<code>foo.runLocal</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">mill foo.run arg1 arg2 arg3
mill foo.runLocal arg1 arg2 arg3</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run
hello WORLD</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_adding_ivy_dependencies"><a class="anchor" href="#_adding_ivy_dependencies"></a>Adding Ivy Dependencies</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-2-ivy-deps.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/2-ivy-deps">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule {
  def scalaVersion = "2.12.17"
  def ivyDeps = Agg(
    ivy"com.lihaoyi::upickle:3.1.0",
    ivy"com.lihaoyi::pprint:0.8.1",
    ivy"${scalaOrganization()}:scala-reflect:${scalaVersion()}"
  )
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can define the <code>ivyDeps</code> field to add ivy dependencies to your module.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Single <code>:</code> syntax (e.g. <code>"ivy"org.testng:testng:6.11"</code>) defines Java
dependencies</p>
</li>
</ul>
</div>
<div class="ulist">
<ul>
<li>
<p>Double <code>::</code> syntax (e.g. <code>ivy"com.lihaoyi::upickle:0.5.1"</code>) defines Scala
dependencies</p>
</li>
<li>
<p>Triple <code>:::</code> syntax (e.g. <code>ivy"org.scalamacros:::paradise:2.1.1"</code>) defines
dependencies cross-published against the full Scala version e.g. <code>2.12.4</code>
instead of just <code>2.12</code>. These are typically Scala compiler plugins or
similar.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To select the test-jars from a dependency use the following syntax:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ivy"org.apache.spark::spark-sql:2.4.0;classifier=tests</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please consult the <a href="Library_Dependencies.html" class="xref page">Library Dependencies in Mill</a> section for even more details.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run i am cow
pretty-printed using PPrint: Array("i", "am", "cow")
serialized using uPickle: ["i","am","cow"]</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_runtime_and_compile_time_dependencies"><a class="anchor" href="#_runtime_and_compile_time_dependencies"></a>Runtime and Compile-time Dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to use additional dependencies at runtime or override
dependencies and their versions at runtime, you can do so with
<code>runIvyDeps</code>.</p>
</div>
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-3-run-compile-deps.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/3-run-compile-deps">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends ScalaModule {
  def scalaVersion = "2.13.8"
  def moduleDeps = Seq(bar)
  def runIvyDeps = Agg(
    ivy"javax.servlet:servlet-api:2.5",
    ivy"org.eclipse.jetty:jetty-server:9.4.42.v20210604",
    ivy"org.eclipse.jetty:jetty-servlet:9.4.42.v20210604"
  )
  def mainClass = Some("bar.Bar")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also declare compile-time-only dependencies with <code>compileIvyDeps</code>.
These are present in the compile classpath, but will not propagated to the
transitive dependencies.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">object bar extends ScalaModule {
  def scalaVersion = "2.13.8"
  def compileIvyDeps = Agg(
    ivy"javax.servlet:servlet-api:2.5",
    ivy"org.eclipse.jetty:jetty-server:9.4.42.v20210604",
    ivy"org.eclipse.jetty:jetty-servlet:9.4.42.v20210604"
  )
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Typically, Mill assumes that a module with compile-time dependencies will
only be run after someone includes the equivalent run-time dependencies in
a later build step. e.g. in the case above, <code>bar</code> defines the compile-time
dependencies, and <code>foo</code> then depends on <code>bar</code> and includes the runtime
dependencies. That is why we can run <code>foo</code> as show below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.runBackground

&gt; curl http://localhost:8079
&lt;html&gt;&lt;body&gt;Hello World!&lt;/body&gt;&lt;/html&gt;</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Compile-time dependencies are translated to <code>provided</code>-scoped
dependencies when publish to Maven or Ivy-Repositories.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_keeping_up_to_date_with_scala_steward"><a class="anchor" href="#_keeping_up_to_date_with_scala_steward"></a>Keeping up-to-date with Scala Steward</h3>
<div class="paragraph">
<p>It&#8217;s always a good idea to keep your dependencies up-to-date.</p>
</div>
<div class="paragraph">
<p>If your project is hosted on GitHub, GitLab, or Bitbucket, you can use
<a href="https://github.com/scala-steward-org/scala-steward">Scala Steward</a> to
automatically open a pull request to update your dependencies whenever
there is a newer version available.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Scala Steward can also keep your
<a href="Scala_Installation_IDE_Support.html#_automatic_mill_updates" class="xref page">Mill version up-to-date</a>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_test_dependencies"><a class="anchor" href="#_test_dependencies"></a>Test Dependencies</h2>
<div class="sectionbody">
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<i class="fa icon-important" title="Important"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>Mill has no <code>test</code>-scoped dependencies!</em></p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>You might be used to test-scoped dependencies from other build tools like
Maven, Gradle or sbt. As test modules in Mill are just regular modules,
there is no special need for a dedicated test-scope. You can use <code>ivyDeps</code>
and <code>runIvyDeps</code> to declare dependencies in test modules, and test modules
can use their <code>moduleDeps</code> to also depend on each other</p>
</div>
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-4-test-deps.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/4-test-deps">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object qux extends ScalaModule {
  def scalaVersion = "2.13.8"
  def moduleDeps = Seq(baz)

  object test extends ScalaTests {
    def ivyDeps = Agg(ivy"com.lihaoyi::utest:0.8.4")
    def testFramework = "utest.runner.Framework"
    def moduleDeps = super.moduleDeps ++ Seq(baz.test)
  }
}


object baz extends ScalaModule {
  def scalaVersion = "2.13.8"

  object test extends ScalaTests {
    def ivyDeps = Agg(ivy"com.lihaoyi::utest:0.8.4")
    def testFramework = "utest.runner.Framework"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>In this example, not only does <code>qux</code> depend on <code>baz</code>, but we also make
<code>qux.test</code> depend on <code>baz.test</code>. That lets <code>qux.test</code> make use of the
<code>BazTestUtils</code> class that <code>baz.test</code> defines, allowing us to re-use this
test helper throughout multiple modules' test suites</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill qux.test
Using BazTestUtils.bazAssertEquals
... qux.QuxTests.simple ...
...

&gt; ./mill baz.test
Using BazTestUtils.bazAssertEquals
... baz.BazTests.simple ...
...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scala_compiler_plugins"><a class="anchor" href="#_scala_compiler_plugins"></a>Scala Compiler Plugins</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-5-scala-compiler-plugins.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/5-scala-compiler-plugins">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule {
  def scalaVersion = "2.13.8"

  def compileIvyDeps = Agg(ivy"com.lihaoyi:::acyclic:0.3.6")
  def scalacOptions = Seq("-P:acyclic:force")
  def scalacPluginIvyDeps = Agg(ivy"com.lihaoyi:::acyclic:0.3.6")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use Scala compiler plugins by setting <code>scalacPluginIvyDeps</code>. The above
example also adds the plugin to <code>compileIvyDeps</code>, since that plugin&#8217;s artifact
is needed on the compilation classpath (though not at runtime).</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
Remember that compiler plugins are published against the full Scala
version (eg. 2.13.8 instead of just 2.13), so when including them make sure to
use the  <code>:::</code> syntax shown above in the example.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill compile
...
error: Unwanted cyclic dependency
error: ...src/Foo.scala...
error:   def y = Bar.z
error: ...src/Bar.scala...
error:   def x = Foo.y</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scaladoc_config"><a class="anchor" href="#_scaladoc_config"></a>Scaladoc Config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To generate API documenation you can use the <code>docJar</code> task on the module you&#8217;d
like to create the documenation for, configured via <code>scalaDocOptions</code> or
<code>javadocOptions</code>:</p>
</div>
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-6-docjar.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/6-docjar">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends ScalaModule {
  def scalaVersion = "3.1.3"

  def scalaDocOptions = Seq("-siteroot", "mydocs", "-no-link-warnings")
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill show foo.docJar

&gt; unzip -p out/foo/docJar.dest/out.jar foo/Foo.html
...
...My Awesome Docs for class Foo...</code></pre>
</div>
</div>
<div class="paragraph">
<p>When using Scala 3 you&#8217;re also able to use Scaladoc to generate a full static
site next to your API documention. This can include general documenation for
your project and even a blog. While you can find the full documenation for this
in the <a href="https://docs.scala-lang.org/scala3/guides/scaladoc/index.html">Scala 3
docs</a>, below you&#8217;ll find some useful information to help you generate this with
Mill.</p>
</div>
<div class="paragraph">
<p>By default, Mill will consider the <em>site root</em> as it&#8217;s called in
<a href="https://docs.scala-lang.org/scala3/guides/scaladoc/static-site.html">Scala 3
docs</a>, to be the value of <code>docResources()</code>. It will look there for your
<code>_docs/</code> and your <code>_blog/</code> directory if any exist. Given a
project called <code>bar</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">object bar extends ScalaModule {
  def scalaVersion = "3.1.3"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Your project structure for this would look something like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre>.
├── build.sc
├── bar
│  ├── docs
│  │  ├── _blog
│  │  │  ├── _posts
│  │  │  │  └── 2022-08-14-hello-world.md
│  │  │  └── index.md
│  │  └── _docs
│  │     ├── getting-started.md
│  │     ├── index.html
│  │     └── index.md
│  └── src
│     └── example
│        └── Hello.scala</pre>
</div>
</div>
<div class="paragraph">
<p>After generating your docs with <code>mill example.docJar</code> you&#8217;ll find by opening
your <code>out/app/docJar.dest/javadoc/index.html</code> locally in your browser you&#8217;ll
have a full static site including your API docs, your blog, and your
documentation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill show bar.docJar

&gt; unzip -p out/bar/docJar.dest/out.jar bar/Bar.html
...
...&lt;p&gt;My Awesome Docs for class Bar&lt;/p&gt;...</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unmanaged_jars"><a class="anchor" href="#_unmanaged_jars"></a>Unmanaged Jars</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-7-unmanaged-jars.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/7-unmanaged-jars">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule {
  def scalaVersion = "2.13.8"
  def unmanagedClasspath = T {
    if (!os.exists(millSourcePath / "lib")) Agg()
    else Agg.from(os.list(millSourcePath / "lib").map(PathRef(_)))
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can override <code>unmanagedClasspath</code> to point it at any jars you place on the
filesystem, e.g. in the above snippet any jars that happen to live in the
<code>lib/</code> folder.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run '{"name":"John","age":30}'     # mac/linux
Key: name, Value: John
Key: age, Value: 30</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_specifying_the_main_class"><a class="anchor" href="#_specifying_the_main_class"></a>Specifying the Main Class</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-8-main-class.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/8-main-class">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule {
  def scalaVersion = "2.13.8"
  def mainClass = Some("foo.Qux")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mill&#8217;s <code>foo.run</code> by default will discover which main class to run from your
compilation output, but if there is more than one or the main class comes from
some library you can explicitly specify which one to use. This also adds the
main class to your <code>foo.jar</code> and <code>foo.assembly</code> jars.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run
Hello Qux</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_downloading_non_maven_jars"><a class="anchor" href="#_downloading_non_maven_jars"></a>Downloading Non-Maven Jars</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-9-downloading-non-maven-jars.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/9-downloading-non-maven-jars">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends RootModule with ScalaModule {
  def scalaVersion = "2.13.8"
  def unmanagedClasspath = T {
    os.write(
      T.dest / "fastjavaio.jar",
      requests.get.stream(
        "https://github.com/williamfiset/FastJavaIO/releases/download/1.1/fastjavaio.jar"
      )
    )
    Agg(PathRef(T.dest / "fastjavaio.jar"))
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also override <code>unmanagedClasspath</code> to point it at jars that you want to
download from arbitrary URLs. Note that targets like <code>unmanagedClasspath</code> are
cached, so your jar is downloaded only once and re-used indefinitely after that.
<code>requests.get</code> comes from the <a href="https://github.com/com-lihaoyi/requests-scala">Requests-Scala</a>
library, which is bundled with Mill</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill run "textfile.txt" # mac/linux
I am cow
hear me moo
I weigh twice as much as you</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_customizing_the_assembly"><a class="anchor" href="#_customizing_the_assembly"></a>Customizing the Assembly</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-10-assembly-config.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/10-assembly-config">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._
import mill.scalalib.Assembly._

object foo extends ScalaModule {
  def moduleDeps = Seq(bar)
  def scalaVersion = "2.13.8"
  def ivyDeps = Agg(ivy"com.lihaoyi::os-lib:0.9.1")
  def assemblyRules = Seq(
    // all application.conf files will be concatenated into single file
    Rule.Append("application.conf"),
    // all *.conf files will be concatenated into single file
    Rule.AppendPattern(".*\\.conf"),
    // all *.temp files will be excluded from a final jar
    Rule.ExcludePattern(".*\\.temp"),
    // the `shapeless` package will be shaded under the `shade` package
    Rule.Relocate("shapeless.**", "shade.shapless.@1")
  )
}

object bar extends ScalaModule {
  def scalaVersion = "2.13.8"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When you make a runnable jar of your project with <code>assembly</code> command,
you may want to exclude some files from a final jar (like signature files,
and manifest files from library jars), and merge duplicated files (for
instance <code>reference.conf</code> files from library dependencies).</p>
</div>
<div class="paragraph">
<p>By default mill excludes all <code>*.sf</code>, <code>*.dsa</code>, <code>*.rsa</code>, and
<code>META-INF/MANIFEST.MF</code> files from assembly, and concatenates all
<code>reference.conf</code> files. You can also define your own merge/exclude rules.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.assembly

&gt; unzip -p ./out/foo/assembly.dest/out.jar application.conf
Bar Application Conf
Foo Application Conf

&gt; java -jar ./out/foo/assembly.dest/out.jar\
Loaded application.conf from resources:...
...Foo Application Conf
...Bar Application Conf</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_repository_config"><a class="anchor" href="#_repository_config"></a>Repository Config</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, dependencies are resolved from maven central, but you can add
your own resolvers by overriding the <code>repositoriesTask</code> task in the module:</p>
</div>
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-11-repository-config.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/11-repository-config">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._
import mill.define.ModuleRef
import coursier.maven.MavenRepository

val sonatypeReleases = Seq(
  MavenRepository("https://oss.sonatype.org/content/repositories/releases")
)

object foo extends ScalaModule {
  def scalaVersion = "2.13.8"

  def ivyDeps = Agg(
    ivy"com.lihaoyi::scalatags:0.12.0",
    ivy"com.lihaoyi::mainargs:0.6.2"
  )

  def repositoriesTask = T.task {
    super.repositoriesTask() ++ sonatypeReleases
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Mill read <a href="https://get-coursier.io/">coursier</a> config files automatically.</p>
</div>
<div class="paragraph">
<p>It is possible to setup mirror with <code>mirror.properties</code></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-properties hljs" data-lang="properties">central.from=https://repo1.maven.org/maven2
central.to=http://example.com:8080/nexus/content/groups/public</code></pre>
</div>
</div>
<div class="paragraph">
<p>Note theses default config file locatations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Linux: <code>~/.config/coursier/mirror.properties</code></p>
</li>
<li>
<p>MacOS: <code>~/Library/Preferences/Coursier/mirror.properties</code></p>
</li>
<li>
<p>Windows: <code>C:\Users\&lt;user_name&gt;\AppData\Roaming\Coursier\config\mirror.properties</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>You can also set the environment variable <code>COURSIER_MIRRORS</code> or the jvm property <code>coursier.mirrors</code> to specify config file location.</p>
</div>
<div class="paragraph">
<p>To add custom resolvers to the initial bootstrap of the build, you can create a
custom <code>ZincWorkerModule</code>, and override the <code>zincWorker</code> method in your
<code>ScalaModule</code> by pointing it to that custom object:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">object CustomZincWorkerModule extends ZincWorkerModule with CoursierModule {
  def repositoriesTask = T.task { super.repositoriesTask() ++ sonatypeReleases }
}

object bar extends ScalaModule {
  def scalaVersion = "2.13.8"
  def zincWorker = ModuleRef(CustomZincWorkerModule)
  // ... rest of your build definitions

  def repositoriesTask = T.task {super.repositoriesTask() ++ sonatypeReleases}
}</code></pre>
</div>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill foo.run --text hello

&gt; ./mill bar.compile</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_maven_central_blocked"><a class="anchor" href="#_maven_central_blocked"></a>Maven Central: Blocked!</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Under some circumstances (e.g. corporate firewalls), you may not have access maven central. The typical symptom will be error messages which look like this;</p>
</div>
<div class="listingblock">
<div class="content">
<pre>1 targets failed
mill.scalalib.ZincWorkerModule.classpath
Resolution failed for 1 modules:
--------------------------------------------
  com.lihaoyi:mill-scalalib-worker_2.13:0.11.1
        not found: C:\Users\partens\.ivy2\local\com.lihaoyi\mill-scalalib-worker_2.13\0.11.1\ivys\ivy.xml
        download error: Caught java.io.IOException (Server returned HTTP response code: 503 for URL: https://repo1.maven.org/maven2/com/lihaoyi/mill-scalalib-worker_2.13/0.11.1/mill-scalalib-worker_2.13-0.11.1.pom) while downloading https://repo1.maven.org/maven2/com/lihaoyi/mill-scalalib-worker_2.13/0.11.1/mill-scalalib-worker_2.13-0.11.1.pom</pre>
</div>
</div>
<div class="paragraph">
<p>It is expected that basic commands (e.g. clean) will not work, as Mill saying it is unable to resolve it&#8217;s own, fundamental, dependancies. Under such circumstances, you will normally have access to some proxy, or other corporate repository which resolves maven artefacts. The strategy is simply to tell mill to use that instead.</p>
</div>
<div class="paragraph">
<p>The idea is to set an environment variable COURSIER_REPOSITORIES (see coursier docs). The below command should set the environment variable for the current shell, and then run the mill command.</p>
</div>
<div class="listingblock">
<div class="content">
<pre> COURSIER_REPOSITORIES=https://packages.corp.com/artifactory/maven/ mill resolve _</pre>
</div>
</div>
<div class="paragraph">
<p>If you are using millw, a more permanent solution could be to set the environment variable at the top of the millw script, or as a user environment variable etc.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_scoverage"><a class="anchor" href="#_scoverage"></a>Scoverage</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-12-contrib-scoverage.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/12-contrib-scoverage">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._
import $ivy.`com.lihaoyi::mill-contrib-scoverage:`

import mill.contrib.scoverage._

object foo extends RootModule with ScoverageModule {
  def scoverageVersion = "2.1.0"
  def scalaVersion = "2.13.11"
  def ivyDeps = Agg(
    ivy"com.lihaoyi::scalatags:0.12.0",
    ivy"com.lihaoyi::mainargs:0.6.2"
  )

  object test extends ScoverageTests /*with TestModule.Utest */{
    def ivyDeps = Agg(ivy"com.lihaoyi::utest:0.8.4")
    def testFramework = "utest.runner.Framework"
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This is a basic Mill build for a single <code>ScalaModule</code>, enhanced with
Scoverage plugin. The root module extends the <code>ScoverageModule</code> and
specifies the version of scoverage version to use here: <code>2.1.0</code>. This
version can be changed if there is a newer one. Now you can call the
scoverage targets to produce coverage reports.
The sub test module extends <code>ScoverageTests</code> to transform the
execution of the various testXXX targets to use scoverage and produce
coverage data.
This lets us perform the coverage operations but before that you
must first run the test.
<code>./mill test</code> then <code>./mill scoverage.consoleReport</code> and get your
coverage into your console output.</p>
</div>
<div class="paragraph">
<p>You can download this example project using the <strong>download</strong> link above
if you want to try out the commands below yourself. The only requirement is
that you have some version of the JVM installed; the <code>./mill</code> script takes
care of any further dependencies that need to be downloaded.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill test # Run the tests and produce the coverage data
...
+ foo.FooTests.simple ...  &lt;h1&gt;hello&lt;/h1&gt;
+ foo.FooTests.escaping ...  &lt;h1&gt;&amp;lt;hello&amp;gt;&lt;/h1&gt;

&gt; ./mill resolve scoverage._ # List what tasks are available to run from scoverage
...
scoverage.consoleReport
...
scoverage.htmlReport
...
scoverage.xmlCoberturaReport
...
scoverage.xmlReport
...

&gt; ./mill scoverage.consoleReport
...
Statement coverage.: 16.67%
Branch coverage....: 100.00%</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_unidoc"><a class="anchor" href="#_unidoc"></a>Unidoc</h2>
<div class="sectionbody">
<div class="listingblock">
<div class="title">build.sc (<a href="https://github.com/com-lihaoyi/mill/releases/download/0.11.13/0.11.13-example-scalamodule-13-unidoc.zip">download</a>, <a href="https://github.com/com-lihaoyi/mill/blob/0.11.13/example/scalamodule/13-unidoc">browse</a>)</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends ScalaModule with UnidocModule{
  def scalaVersion = "2.13.8"
  def moduleDeps = Seq(bar, qux)

  object bar extends ScalaModule{
    def scalaVersion = "2.13.8"
  }

  object qux extends ScalaModule {
    def scalaVersion = "2.13.8"
    def moduleDeps = Seq(bar)
  }

  def unidocVersion = Some("0.1.0")
  def unidocSourceUrl = Some("https://github.com/lihaoyi/test/blob/master")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This example demonstrates use of <code>mill.scalalib.UnidocModule</code>. This can be
mixed in to any <code>ScalaModule</code>, and generates a combined Scaladoc for the
module and all its transitive dependencies. Two targets are provided:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>.unidocLocal</code>: this generates a site suitable for local browsing. If
unidocSourceUrl is provided, the scaladoc provides links back to the
local sources</p>
</li>
<li>
<p><code>.unidocSite</code>: this generates a site suitable for local browsing. If
unidocSourceUrl is provided, the scaladoc provides links back to the
sources as browsable from the <code>unidocSourceUrl</code> base (e.g. on Github)</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-bash hljs" data-lang="bash">&gt; ./mill show foo.unidocLocal
".../out/foo/unidocLocal.dest"

&gt; cat out/foo/unidocLocal.dest/foo/Foo.html
...
...My Eloquent Scaladoc for Foo...

&gt; cat out/foo/unidocLocal.dest/foo/qux/Qux.html
...
...My Excellent Scaladoc for Qux...

&gt; cat out/foo/unidocLocal.dest/foo/bar/Bar.html
...
...My Lucid Scaladoc for Bar...

&gt; ./mill show foo.unidocSite</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_reformatting_your_code"><a class="anchor" href="#_reformatting_your_code"></a>Reformatting your code</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mill supports code formatting via <a href="https://scalameta.org/scalafmt/">scalafmt</a> out of the box.</p>
</div>
<div class="paragraph">
<p>To have a formatting per-module you need to make your module extend <code>mill.scalalib.scalafmt.ScalafmtModule</code>:</p>
</div>
<div class="listingblock">
<div class="title"><code>build.sc</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._, scalafmt._

object foo extends ScalaModule with ScalafmtModule {
  def scalaVersion = "2.13.14"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now you can reformat code with <code>mill foo.reformat</code> command, or only check for misformatted files with <code>mill foo.checkFormat</code>.</p>
</div>
<div class="paragraph">
<p>You can also reformat your project&#8217;s code globally with <code>mill mill.scalalib.scalafmt.ScalafmtModule/reformatAll __.sources</code> command,
or only check the code&#8217;s format with <code>mill mill.scalalib.scalafmt.ScalafmtModule/checkFormatAll __.sources</code>.
It will reformat all sources that matches <code>__.sources</code> query.</p>
</div>
<div class="paragraph">
<p>If you add a <code>.scalafmt.conf</code> file at the root of you project, it will be used
to configure formatting. It can contain a <code>version</code> key to specify the scalafmt
version used to format your code. See the
<a href="https://scalameta.org/scalafmt/docs/configuration.html">scalafmt configuration documentation</a>
for details.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_using_the_ammonite_repl_scala_console"><a class="anchor" href="#_using_the_ammonite_repl_scala_console"></a>Using the Ammonite Repl / Scala console</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All <code>ScalaModule</code>s have a <code>console</code> and a <code>repl</code> target, to start a Scala console or an Ammonite Repl.</p>
</div>
<div class="paragraph">
<p>When using the <code>console</code>, you can configure its <code>scalac</code> options using the <code>consoleScalacOptions</code> target.</p>
</div>
<div class="paragraph">
<p>For example, you may want to inherit all of your regular <code>scalacOptions</code> but disable <code>-Xfatal-warnings</code>:</p>
</div>
<div class="listingblock">
<div class="title">Example: Using <code>consoleScalacOptions</code> to disable fatal warnings</div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends ScalaModule {
  def consoleScalacOptions = scalacOptions().filterNot(o =&gt; o == "-Xfatal-warnings")
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>To use the <code>repl</code>, you can (and sometimes need to) customize the Ammonite version to work with your selected Scala version.
Mill provides a default Ammonite version,
but depending on the Scala version you are using, there may be no matching Ammonite release available.
In order to start the repl, you may have to specify a different available Ammonite version.</p>
</div>
<div class="listingblock">
<div class="title">Example: Overriding <code>ammoniteVersion</code> to select a release compatible to the <code>scalaVersion</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._. scalalib._

object foo extends ScalaModule {
  def scalaVersion = "2.12.6"
  def ammoniteVersion = "2.4.0"
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p><em>Why is Ammonite tied to the exact Scala version?</em></p>
</div>
<div class="paragraph">
<p>This is because Ammonite depends on the Scala compiler.
In contrast to the Scala library, compiler releases do not guarantee any binary compatibility between releases.
As a consequence, Ammonite needs full Scala version specific releases.</p>
</div>
<div class="paragraph">
<p>The older your used Mill version or the newer the Scala version you want to use, the higher is the risk that the default Ammonite version will not match.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_disabling_incremental_compilation_with_zinc"><a class="anchor" href="#_disabling_incremental_compilation_with_zinc"></a>Disabling incremental compilation with Zinc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default all `ScalaModule`s use incremental compilation via <a href="https://github.com/sbt/zinc">Zinc</a> to
only recompile sources that have changed since the last compile, or ones that have been invalidated
by changes to upstream sources.</p>
</div>
<div class="paragraph">
<p>If for any reason you want to disable incremental compilation for a module, you can override and set
<code>zincIncrementalCompilation</code> to <code>false</code></p>
</div>
<div class="listingblock">
<div class="title"><code>build.sc</code></div>
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._, scalalib._

object foo extends ScalaModule {
  def zincIncrementalCompilation = false
}</code></pre>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="Scala_Build_Examples.html">Scala Build Examples</a></span>
  <span class="next"><a href="Scala_Web_Build_Examples.html">Scala Web Build Examples</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
<script src="../../_/js/vendor/lunr.js"></script>
<script src="../../_/js/search-ui.js" id="search-ui-script" data-site-root-path="../.." data-snippet-length="100" data-stylesheet="../../_/css/search.css"></script>
<script async src="../../search-index.js"></script>
  </body>
</html>
