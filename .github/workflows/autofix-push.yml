name: 'push autofix'
on:
  workflow_run:
    workflows: ['autofix']
    types:
      - completed
permissions:
  contents: read
  actions: read
  checks: write
jobs:
  report:
    runs-on: ubuntu-latest
    steps:
      - uses: dawidd6/action-download-artifact@v2
        with:
          workflow: ${{ github.event.workflow_run.workflow_id }}
          workflow_conclusion: ""
          name: autofix-artifacts

      - run: >
          cat .autofix-repo
          cat .autofix-branch
          if git diff --quiet HEAD~1; then
            echo "The latest commit is empty (no changes)."
          else
            git push $(cat .autofix-repo) $(cat .autofix-branch)
          fi
