package build.list

import mill.javalib.*
import mill.javalib.errorprone.*
import millbuild.*

object `package` extends ErrorProneModule with ProjectBaseModule {

  def errorProneVersion = "2.28.0"

  def errorProneJavacEnableOptions = super.errorProneJavacEnableOptions() ++
    Opts("-XDshould-stop.ifError=FLOW", "-XDshouldStopPolicyIfError=FLOW")

  object test extends MavenTests with ErrorProneModule with TestModule.Junit5 {

    def mvnDeps = super.mvnDeps() ++ Seq(Deps.junitJupiter)

    def errorProneVersion = "2.28.0"

    def errorProneOptions = super.errorProneOptions() ++
      Seq("-XepCompilingTestOnlyCode")

    def errorProneJavacEnableOptions = super.errorProneJavacEnableOptions() ++
      Opts("-XDshould-stop.ifError=FLOW", "-XDshouldStopPolicyIfError=FLOW")

    def testParallelism = false

    def testSandboxWorkingDir = false

  }

}
