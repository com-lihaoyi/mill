package build.full

import mill.*
import mill.api.*
import mill.api.opt.*
import mill.javalib.*
import mill.javalib.publish.*
import mill.scalajslib.*
import mill.scalajslib.api.*
import mill.scalalib.*
import mill.scalanativelib.*
import millbuild.*

object `package` extends Module {

  object js extends ScalaJSModule with CrossprojectBaseModule {

    def scalaJSVersion = "1.16.0"

    def moduleDeps = super.moduleDeps ++ Seq(build.pure.js)

    def artifactName = "full"

    def sourcesRootFolders = super.sourcesRootFolders ++ Seq(os.sub / "shared")

    def pomSettings = PomSettings(
      "full",
      "full",
      "",
      Seq(),
      VersionControl(None, None, None, None),
      Seq()
    )

    object test
        extends ScalaJSTests
        with SbtPlatformTests
        with SbtTests
        with TestModule.Utest {

      def mvnDeps = super.mvnDeps() ++ Seq(Deps.utest)

      def moduleDeps = super.moduleDeps ++ Seq(build.pure.js.test)

      def testParallelism = false

      def testSandboxWorkingDir = false

    }

  }

  object jvm extends CrossprojectBaseModule {

    def moduleDeps = super.moduleDeps ++ Seq(build.pure.jvm)

    def artifactName = "full"

    def sourcesRootFolders = super.sourcesRootFolders ++ Seq(os.sub / "shared")

    def pomSettings = PomSettings(
      "full",
      "full",
      "",
      Seq(),
      VersionControl(None, None, None, None),
      Seq()
    )

    object test extends SbtPlatformTests with SbtTests with TestModule.Utest {

      def mvnDeps = super.mvnDeps() ++ Seq(Deps.utest)

      def moduleDeps = super.moduleDeps ++ Seq(build.pure.jvm.test)

      def testParallelism = false

      def testSandboxWorkingDir = false

    }

  }

  object native extends ScalaNativeModule with CrossprojectBaseModule {

    def scalaNativeVersion = "0.5.4"

    def moduleDeps = super.moduleDeps ++ Seq(build.pure.native)

    def artifactName = "full"

    def sourcesRootFolders = super.sourcesRootFolders ++ Seq(os.sub / "shared")

    def pomSettings = PomSettings(
      "full",
      "full",
      "",
      Seq(),
      VersionControl(None, None, None, None),
      Seq()
    )

    object test
        extends ScalaNativeTests
        with SbtPlatformTests
        with SbtTests
        with TestModule.Utest {

      def mvnDeps = super.mvnDeps() ++ Seq(Deps.utest)

      def moduleDeps = super.moduleDeps ++ Seq(build.pure.native.test)

      def testParallelism = false

      def testSandboxWorkingDir = false

    }

  }

}
