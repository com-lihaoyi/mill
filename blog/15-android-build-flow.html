<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html>
<html lang="en"><head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Mill as an Alternative Android Build Tool :: The Mill Build Tool</title>
    <link rel="canonical" href="https://mill-build.org/blog/15-android-build-flow.html" />
    <link rel="prev" href="16-zero-setup.html" />
    <link rel="next" href="14-bash-zsh-completion.html" />
    <meta name="generator" content="Antora 3.1.12" />
    <link rel="stylesheet" href="../_/css/site.css" />
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-1C582ZJR85"></script>
    <script>function gtag(){dataLayer.push(arguments)};window.dataLayer=window.dataLayer||[];gtag('js',new Date());gtag('config','G-1C582ZJR85')</script>
<link rel="icon" href="../_/favicon.png" type="image/x-icon" />
  
  <style>
  /* auto-hyphenation is super ugly */
  *{
    hyphens: manual !important;
  }

  /* Reduce font size from 17px to something reasonable */
  .doc {
   font-size: 16px !important;
  }
  .doc pre {
   font-size: 14px !important;
  }
  /* Shrink unreasonably large top bar */
  nav.navbar{
    height: 2.5rem;
  }
  body.article{
    padding-top: 2.5rem;
  }
  div.nav-container{
    top: 2.5rem;
  }
  div.toolbar{
    top: 2.5rem;
  }
  aside.nav{
    top: 2.5rem;
    height: calc(100vh - 2.5rem);
  }
  </style></head><body class="article">
  
<header class="header">
  
  <script>
  gtag('config', 'AW-16649289906');

  document.addEventListener('DOMContentLoaded', function() {
  const links = document.querySelectorAll('a');
    links.forEach(link => {
      if (link.textContent.trim().toLowerCase() === 'download') {
        link.addEventListener('click', function(event) {
          console.log("download link clicked")
          gtag('event', 'conversion', {'send_to': 'AW-16649289906/rsphCKfVq8QZELKBgIM-'});
        });
      }
    });
  });
  </script>
  <nav class="navbar">
    <div class="navbar-brand">
      <!-- TODO: add mill icon -->
      <a class="navbar-item" href="https://mill-build.org"><img src="../_/logo-white.svg" height="20" />Â The Mill Build Tool</a>
      <div class="navbar-item search">
        <input id="search-input" type="text" placeholder="Search the docs" />
      </div>
      <button class="navbar-burger" data-target="topbar-nav">
        <span></span>
        <span></span>
        <span></span>
      </button>
    </div>
    <div id="topbar-nav" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill">GitHub</a>
        <a class="navbar-item" href="https://mill-build.org/blog/index.html">Blog</a>
        <a class="navbar-item" href="https://mill-build.org/api/latest/mill.html">API</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/issues">Issues</a>
        <a class="navbar-item" href="https://github.com/com-lihaoyi/mill/discussions">Discuss</a>


            <!--
        <a class="navbar-item" href="#">Home</a>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Documentation</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#"></a>
            <a class="navbar-item" href="#">Product B</a>
            <a class="navbar-item" href="#">Product C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Plugins</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Service A</a>
            <a class="navbar-item" href="#">Service B</a>
            <a class="navbar-item" href="#">Service C</a>
          </div>
        </div>
        <div class="navbar-item has-dropdown is-hoverable">
          <a class="navbar-link" href="#">Resources</a>
          <div class="navbar-dropdown">
            <a class="navbar-item" href="#">Resource A</a>
            <a class="navbar-item" href="#">Resource B</a>
            <a class="navbar-item" href="#">Resource C</a>
          </div>
        </div>
        <div class="navbar-item">
          <span class="control">
            <a class="button is-primary" href="#">Download</a>
          </span>
        </div>
        -->
      </div>
    </div>
  </nav>
</header>
<div class="body">
<div class="nav-container" data-component="blog" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
<ul class="nav-list">

  <li class="nav-item" data-depth="0">
<ul class="nav-list">

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="index.html"><em>The Mill Build Engineering Blog</em></a>
  </li>

  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="16-zero-setup.html">Zero-Setup Java Build Tooling via Mill Bootstrap Scripts</a>
  </li>

  <li class="nav-item is-current-page" data-depth="1">
    <a class="nav-link" href="15-android-build-flow.html">Mill as an Alternative Android Build Tool</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="14-bash-zsh-completion.html">Writing Your Own Simple Tab-Completions for Bash and Zsh</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="13-mill-build-tool-v1-0-0.html">Mill Build Tool v1.0.0 Release Highlights</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="12-direct-style-build-tool.html">Mill as a Direct Style Build Tool</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="11-jvm-test-parallelism.html">Strategies for Efficiently Parallelizing JVM Test Suites</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="10-bytecode-callgraph-analysis.html">Invalidating build caches using JVM bytecode callgraph analysis</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="9-mill-faster-assembly-jars.html">Fast Incremental JVM Assembly Jar Creation with Mill</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="8-what-is-a-build-tool.html">What does a Build Tool do?</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="7-graal-native-executables.html">How to Compile Java into Native Binaries with Mill and Graal</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="6-garbage-collector-perf.html">Understanding JVM Garbage Collector Performance</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="5-executable-jars.html">How JVM Executable Assembly Jars Work</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="4-flaky-tests.html">How To Manage Flaky Tests in your CI Workflows</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="3-selective-testing.html">Faster CI with Selective Testing</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="2-monorepo-build-tool.html">Why Use a Monorepo Build Tool?</a>
  </li>

  <li class="nav-item is-active" data-depth="1">
    <a class="nav-link" href="1-java-compile.html">How Fast Does Java Compile?</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">The Mill Build Engineering Blog</span>
    <span class="version"></span>
  </div>
  <ul class="components">
    <li class="component">
      <div class="title"><a href="../mill/index.html">Mill Documentation</a></div>
      <ul class="versions">
        <li class="version">
          <a href="../mill/main-branch/index.html">main-branch</a>
        </li>
        <li class="version">
          <a href="../mill/dev-1.1.0-RC2-40-0576e4/index.html">dev-1.1.0-RC2-40-0576e4</a>
        </li>
        <li class="version is-latest">
          <a href="../mill/index.html">1.1.0-RC2</a>
        </li>
        <li class="version">
          <a href="../mill/1.0.x/index.html">1.0.6</a>
        </li>
        <li class="version">
          <a href="../mill/0.12.x/index.html">0.12.16</a>
        </li>
        <li class="version">
          <a href="../mill/0.11.x/index.html">0.11.13</a>
        </li>
        <li class="version">
          <a href="../mill/0.10.15/index.html">0.10.15</a>
        </li>
        <li class="version">
          <a href="../mill/0.9.12/index.html">0.9.12</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <div class="title"><a href="index.html">The Mill Build Engineering Blog</a></div>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">

<div class="toolbar" role="navigation" style="position: fixed; top: 2.5rem; height: 2rem; left: 0px;">
<button class="nav-toggle"></button>
</div>
<div class="toolbar" style="position: fixed; top: 2.5rem; height: 1.5rem; right: 0px;">
<div class="edit-this-page"><a href="https://github.com/com-lihaoyi/mill/edit/main/out/website/blogFolder.dest/modules/ROOT/pages/15-android-build-flow.adoc">Edit this Page</a></div>
</div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Mill as an Alternative Android Build Tool</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p><em>Vasilis Nicolaou, 17 September 2025</em></p>
</div>
<div class="paragraph">
<p>Until recently, Gradle was the only realistic option for Android builds. Today, Mill provides an alternative to Gradle that is easier to use and learn.</p>
</div>
<div class="paragraph">
<p>In less than a year, Mill went from minimal Android support to producing installable APKs for projects as complex as:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="../mill/android/hilt-sample.html" class="xref page">Jetpack Compose + Dependency Injection with Hilt</a></p>
</li>
<li>
<p><a href="../mill/android/java.html#_using_third_party_native_libraries" class="xref page">Android Native</a></p>
</li>
<li>
<p><a href="../mill/android/compose-samples.html" class="xref page">Jetpack Compose</a>.</p>
</li>
<li>
<p>Multi-module Pokedex sample app (<a href="https://github.com/NicosNicolaou16/Pokedex_Compose_Multi_Module">original</a>, <a href="https://github.com/vaslabs/Pokedex_Compose_Multi_Module/tree/testing-mill">with mill</a>)
<span class="image"><img src="_images/AndroidPokedexMultimoduleExample.png" alt="A multi-module Android app built with Mill" width="showing a list of Pok&eacute;mon and details for each pokemon." /></span></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_why_you_might_prefer_this_to_gradle"><a class="anchor" href="#_why_you_might_prefer_this_to_gradle"></a>Why you might prefer this to Gradle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Because Mill&rsquo;s Android support is built out of simple, object-oriented modules (AndroidModule, AndroidAppModule, etc.), the entire pipeline is transparent and hackable. If something doesn&rsquo;t work, you don&rsquo;t need to wait for a plugin update, you can open the task in your IDE, see the source, and tweak it yourself. This is the same design that let us implement end-to-end Android support in under a year, and it&rsquo;s what makes Mill attractive if you value control and debuggability in your build.</p>
</div>
<div class="paragraph">
<p>For example, you can inspect how Mill builds an Android APK with:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./mill inspect __.androidApk
[1/1] inspect
app.androidApk(AndroidAppModule.scala:439)
    Signs the APK using a keystore to generate a final, distributable APK.

    The signing step is mandatory to distribute Android applications. It adds a cryptographic
    signature to the APK, verifying its authenticity. This method uses the `apksigner` tool
    along with a keystore file to sign the APK.

    If no keystore is available, a new one is generated using the `keytool` utility.

    For more details on the apksigner tool, refer to:
    [[https://developer.android.com/tools/apksigner apksigner Documentation]]

Inputs:
    androidSdkModule0.apksignerPath
    app.androidAlignedUnsignedApk
    app.androidSignKeyDetails
...</code></pre>
</div>
</div>
<div class="paragraph">
<p>This post is a walkthrough of the basic Android build flow in Mill: what it does, why it&rsquo;s complex, and why Mill makes it easier to reason about.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_android_build_process"><a class="anchor" href="#_the_android_build_process"></a>The Android build process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Building and running a mixed Java/Kotlin application can be as simple as:</p>
</div>
<div class="paragraph">
<center>
<svg width="150px" height="215px" viewBox="0.00 0.00 149.59 215.20" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.0 1.0) rotate(0.0) translate(4.0 211.2)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-211.2 145.59,-211.2 145.59,4 -4,4"></polygon>
<!-- Sources -->
<g id="node1" class="node">
<title>Sources</title>
<polygon fill="none" stroke="black" points="101.11,-207.1 40.48,-207.1 40.48,-182.5 101.11,-182.5 101.11,-207.1"></polygon>
<text text-anchor="middle" x="70.79" y="-190.6" font-family="Times,serif" font-size="14.00">Sources</text>
</g>
<!-- Compile (Java/Kotlin) -->
<g id="node2" class="node">
<title>Compile (Java/Kotlin)</title>
<polygon fill="none" stroke="black" points="141.38,-146.3 0.21,-146.3 0.21,-121.7 141.38,-121.7 141.38,-146.3"></polygon>
<text text-anchor="middle" x="70.79" y="-129.8" font-family="Times,serif" font-size="14.00">Compile (Java/Kotlin)</text>
</g>
<!-- Sources&#45;&gt;Compile (Java/Kotlin) -->
<g id="edge1" class="edge">
<title>Sources-&gt;Compile (Java/Kotlin)</title>
<path fill="none" stroke="black" d="M70.79,-182.46C70.79,-175.06 70.79,-165.16 70.79,-156.32"></path>
<polygon fill="black" stroke="black" points="74.29,-156.3 70.79,-146.3 67.29,-156.3 74.29,-156.3"></polygon>
</g>
<!-- Jar -->
<g id="node3" class="node">
<title>Jar</title>
<polygon fill="none" stroke="black" points="87.11,-85.5 54.47,-85.5 54.47,-60.9 87.11,-60.9 87.11,-85.5"></polygon>
<text text-anchor="middle" x="70.79" y="-69" font-family="Times,serif" font-size="14.00">Jar</text>
</g>
<!-- Compile (Java/Kotlin)&#45;&gt;Jar -->
<g id="edge2" class="edge">
<title>Compile (Java/Kotlin)-&gt;Jar</title>
<path fill="none" stroke="black" d="M70.79,-121.66C70.79,-114.26 70.79,-104.36 70.79,-95.52"></path>
<polygon fill="black" stroke="black" points="74.29,-95.5 70.79,-85.5 67.29,-95.5 74.29,-95.5"></polygon>
</g>
<!-- Run -->
<g id="node4" class="node">
<title>Run</title>
<polygon fill="none" stroke="black" points="90.63,-24.7 50.96,-24.7 50.96,-0.1 90.63,-0.1 90.63,-24.7"></polygon>
<text text-anchor="middle" x="70.79" y="-8.2" font-family="Times,serif" font-size="14.00">Run</text>
</g>
<!-- Jar&#45;&gt;Run -->
<g id="edge3" class="edge">
<title>Jar-&gt;Run</title>
<path fill="none" stroke="black" d="M70.79,-60.86C70.79,-53.46 70.79,-43.56 70.79,-34.72"></path>
<polygon fill="black" stroke="black" points="74.29,-34.7 70.79,-24.7 67.29,-34.7 74.29,-34.7"></polygon>
</g>
</g>
</svg>

</center>
</div>
<div class="paragraph">
<p>Android adds a dozen more steps, each involving different tools and formats:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Resource compilation (aapt2) for layouts, drawables, and strings</p>
</li>
<li>
<p>Manifest merging (app + library manifests)</p>
</li>
<li>
<p>Code shrinking and obfuscation (R8/Proguard)</p>
</li>
<li>
<p>DEX bytecode conversion (d8/r8)</p>
</li>
<li>
<p>APK packaging (resources + bytecode)</p>
</li>
<li>
<p>App signing (debug or release keystores)</p>
</li>
<li>
<p>Emulator deployment and test execution (ADB)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each step is order-sensitive: resources must be compiled before classes, manifests merged before packaging, APKs signed before installation. With Gradle, these steps are usually hidden inside plugin logic. When we explored Gradle builds, we often had to reverse engineer its behavior to understand what was going on. Mill instead exposes each phase as a target you can call, inspect its sources, or override.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_the_mill_android_build_pipeline"><a class="anchor" href="#_the_mill_android_build_pipeline"></a>The Mill Android Build Pipeline</h2>
<div class="sectionbody">
<div class="paragraph">
<center>
<svg width="470px" height="519px" viewBox="0.00 0.00 469.64 519.20" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.0 1.0) rotate(0.0) translate(4.0 515.2)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-515.2 465.64,-515.2 465.64,4 -4,4"></polygon>
<!-- Java/Kotlin Sources -->
<g id="node1" class="node">
<title>Java/Kotlin Sources</title>
<polygon fill="none" stroke="black" points="135.15,-511.1 6.43,-511.1 6.43,-486.5 135.15,-486.5 135.15,-511.1"></polygon>
<text text-anchor="middle" x="70.79" y="-494.6" font-family="Times,serif" font-size="14.00">Java/Kotlin Sources</text>
</g>
<!-- Compile (Java/Kotlin) -->
<g id="node2" class="node">
<title>Compile (Java/Kotlin)</title>
<polygon fill="none" stroke="black" points="141.38,-450.3 0.21,-450.3 0.21,-425.7 141.38,-425.7 141.38,-450.3"></polygon>
<text text-anchor="middle" x="70.79" y="-433.8" font-family="Times,serif" font-size="14.00">Compile (Java/Kotlin)</text>
</g>
<!-- Java/Kotlin Sources&#45;&gt;Compile (Java/Kotlin) -->
<g id="edge1" class="edge">
<title>Java/Kotlin Sources-&gt;Compile (Java/Kotlin)</title>
<path fill="none" stroke="black" d="M70.79,-486.46C70.79,-479.06 70.79,-469.16 70.79,-460.32"></path>
<polygon fill="black" stroke="black" points="74.29,-460.3 70.79,-450.3 67.29,-460.3 74.29,-460.3"></polygon>
</g>
<!-- Compiled Classes -->
<g id="node8" class="node">
<title>Compiled Classes</title>
<polygon fill="none" stroke="black" points="129.01,-389.5 12.58,-389.5 12.58,-364.9 129.01,-364.9 129.01,-389.5"></polygon>
<text text-anchor="middle" x="70.79" y="-373" font-family="Times,serif" font-size="14.00">Compiled Classes</text>
</g>
<!-- Compile (Java/Kotlin)&#45;&gt;Compiled Classes -->
<g id="edge6" class="edge">
<title>Compile (Java/Kotlin)-&gt;Compiled Classes</title>
<path fill="none" stroke="black" d="M70.79,-425.66C70.79,-418.26 70.79,-408.36 70.79,-399.52"></path>
<polygon fill="black" stroke="black" points="74.29,-399.5 70.79,-389.5 67.29,-399.5 74.29,-399.5"></polygon>
</g>
<!-- Resources (res/) -->
<g id="node3" class="node">
<title>Resources (res/)</title>
<polygon fill="none" stroke="black" points="284.86,-450.3 178.73,-450.3 178.73,-425.7 284.86,-425.7 284.86,-450.3"></polygon>
<text text-anchor="middle" x="231.79" y="-433.8" font-family="Times,serif" font-size="14.00">Resources (res/)</text>
</g>
<!-- Compile Resources (aapt2) -->
<g id="node4" class="node">
<title>Compile Resources (aapt2)</title>
<polygon fill="none" stroke="black" points="316.19,-389.5 147.4,-389.5 147.4,-364.9 316.19,-364.9 316.19,-389.5"></polygon>
<text text-anchor="middle" x="231.79" y="-373" font-family="Times,serif" font-size="14.00">Compile Resources (aapt2)</text>
</g>
<!-- Resources (res/)&#45;&gt;Compile Resources (aapt2) -->
<g id="edge2" class="edge">
<title>Resources (res/)-&gt;Compile Resources (aapt2)</title>
<path fill="none" stroke="black" d="M231.79,-425.66C231.79,-418.26 231.79,-408.36 231.79,-399.52"></path>
<polygon fill="black" stroke="black" points="235.29,-399.5 231.79,-389.5 228.29,-399.5 235.29,-399.5"></polygon>
</g>
<!-- Linked Resources -->
<g id="node7" class="node">
<title>Linked Resources</title>
<polygon fill="none" stroke="black" points="289.98,-328.7 173.61,-328.7 173.61,-304.1 289.98,-304.1 289.98,-328.7"></polygon>
<text text-anchor="middle" x="231.79" y="-312.2" font-family="Times,serif" font-size="14.00">Linked Resources</text>
</g>
<!-- Compile Resources (aapt2)&#45;&gt;Linked Resources -->
<g id="edge5" class="edge">
<title>Compile Resources (aapt2)-&gt;Linked Resources</title>
<path fill="none" stroke="black" d="M231.79,-364.86C231.79,-357.46 231.79,-347.56 231.79,-338.72"></path>
<polygon fill="black" stroke="black" points="235.29,-338.7 231.79,-328.7 228.29,-338.7 235.29,-338.7"></polygon>
</g>
<!-- AndroidManifest.xml -->
<g id="node5" class="node">
<title>AndroidManifest.xml</title>
<polygon fill="none" stroke="black" points="461.49,-450.3 324.09,-450.3 324.09,-425.7 461.49,-425.7 461.49,-450.3"></polygon>
<text text-anchor="middle" x="392.79" y="-433.8" font-family="Times,serif" font-size="14.00">AndroidManifest.xml</text>
</g>
<!-- Manifest Merging -->
<g id="node6" class="node">
<title>Manifest Merging</title>
<polygon fill="none" stroke="black" points="451.77,-389.5 333.82,-389.5 333.82,-364.9 451.77,-364.9 451.77,-389.5"></polygon>
<text text-anchor="middle" x="392.79" y="-373" font-family="Times,serif" font-size="14.00">Manifest Merging</text>
</g>
<!-- AndroidManifest.xml&#45;&gt;Manifest Merging -->
<g id="edge3" class="edge">
<title>AndroidManifest.xml-&gt;Manifest Merging</title>
<path fill="none" stroke="black" d="M392.79,-425.66C392.79,-418.26 392.79,-408.36 392.79,-399.52"></path>
<polygon fill="black" stroke="black" points="396.29,-399.5 392.79,-389.5 389.29,-399.5 396.29,-399.5"></polygon>
</g>
<!-- Manifest Merging&#45;&gt;Linked Resources -->
<g id="edge4" class="edge">
<title>Manifest Merging-&gt;Linked Resources</title>
<path fill="none" stroke="black" d="M361.75,-364.86C336.25,-355.55 299.93,-342.29 272.17,-332.15"></path>
<polygon fill="black" stroke="black" points="273.33,-328.85 262.74,-328.7 270.93,-335.42 273.33,-328.85"></polygon>
</g>
<!-- Package APK -->
<g id="node9" class="node">
<title>Package APK</title>
<polygon fill="none" stroke="black" points="198.93,-267.9 104.66,-267.9 104.66,-243.3 198.93,-243.3 198.93,-267.9"></polygon>
<text text-anchor="middle" x="151.79" y="-251.4" font-family="Times,serif" font-size="14.00">Package APK</text>
</g>
<!-- Linked Resources&#45;&gt;Package APK -->
<g id="edge7" class="edge">
<title>Linked Resources-&gt;Package APK</title>
<path fill="none" stroke="black" d="M216.37,-304.06C204.75,-295.52 188.61,-283.66 175.37,-273.93"></path>
<polygon fill="black" stroke="black" points="177.3,-271 167.17,-267.9 173.16,-276.65 177.3,-271"></polygon>
</g>
<!-- DEX (d8/r8) -->
<g id="node10" class="node">
<title>DEX (d8/r8)</title>
<polygon fill="none" stroke="black" points="135.43,-328.7 48.16,-328.7 48.16,-304.1 135.43,-304.1 135.43,-328.7"></polygon>
<text text-anchor="middle" x="91.79" y="-312.2" font-family="Times,serif" font-size="14.00">DEX (d8/r8)</text>
</g>
<!-- Compiled Classes&#45;&gt;DEX (d8/r8) -->
<g id="edge8" class="edge">
<title>Compiled Classes-&gt;DEX (d8/r8)</title>
<path fill="none" stroke="black" d="M74.84,-364.86C77.54,-357.3 81.18,-347.13 84.39,-338.14"></path>
<polygon fill="black" stroke="black" points="87.69,-339.3 87.76,-328.7 81.1,-336.94 87.69,-339.3"></polygon>
</g>
<!-- Code Shrinking (r8/Proguard) -->
<g id="node11" class="node">
<title>Code Shrinking (r8/Proguard)</title>
<polygon fill="none" stroke="black" points="243.76,-207.1 59.83,-207.1 59.83,-182.5 243.76,-182.5 243.76,-207.1"></polygon>
<text text-anchor="middle" x="151.79" y="-190.6" font-family="Times,serif" font-size="14.00">Code Shrinking (r8/Proguard)</text>
</g>
<!-- Package APK&#45;&gt;Code Shrinking (r8/Proguard) -->
<g id="edge10" class="edge">
<title>Package APK-&gt;Code Shrinking (r8/Proguard)</title>
<path fill="none" stroke="black" d="M151.79,-243.26C151.79,-235.86 151.79,-225.96 151.79,-217.12"></path>
<polygon fill="black" stroke="black" points="155.29,-217.1 151.79,-207.1 148.29,-217.1 155.29,-217.1"></polygon>
</g>
<!-- DEX (d8/r8)&#45;&gt;Package APK -->
<g id="edge9" class="edge">
<title>DEX (d8/r8)-&gt;Package APK</title>
<path fill="none" stroke="black" d="M103.36,-304.06C111.75,-295.85 123.26,-284.56 132.97,-275.05"></path>
<polygon fill="black" stroke="black" points="135.57,-277.4 140.26,-267.9 130.67,-272.4 135.57,-277.4"></polygon>
</g>
<!-- Sign APK -->
<g id="node12" class="node">
<title>Sign APK</title>
<polygon fill="none" stroke="black" points="188.46,-146.3 115.12,-146.3 115.12,-121.7 188.46,-121.7 188.46,-146.3"></polygon>
<text text-anchor="middle" x="151.79" y="-129.8" font-family="Times,serif" font-size="14.00">Sign APK</text>
</g>
<!-- Code Shrinking (r8/Proguard)&#45;&gt;Sign APK -->
<g id="edge11" class="edge">
<title>Code Shrinking (r8/Proguard)-&gt;Sign APK</title>
<path fill="none" stroke="black" d="M151.79,-182.46C151.79,-175.06 151.79,-165.16 151.79,-156.32"></path>
<polygon fill="black" stroke="black" points="155.29,-156.3 151.79,-146.3 148.29,-156.3 155.29,-156.3"></polygon>
</g>
<!-- Install to Emulator -->
<g id="node13" class="node">
<title>Install to Emulator</title>
<polygon fill="none" stroke="black" points="212.28,-85.5 91.31,-85.5 91.31,-60.9 212.28,-60.9 212.28,-85.5"></polygon>
<text text-anchor="middle" x="151.79" y="-69" font-family="Times,serif" font-size="14.00">Install to Emulator</text>
</g>
<!-- Sign APK&#45;&gt;Install to Emulator -->
<g id="edge12" class="edge">
<title>Sign APK-&gt;Install to Emulator</title>
<path fill="none" stroke="black" d="M151.79,-121.66C151.79,-114.26 151.79,-104.36 151.79,-95.52"></path>
<polygon fill="black" stroke="black" points="155.29,-95.5 151.79,-85.5 148.29,-95.5 155.29,-95.5"></polygon>
</g>
<!-- Run/Test via ADB -->
<g id="node14" class="node">
<title>Run/Test via ADB</title>
<polygon fill="none" stroke="black" points="212.28,-24.7 91.31,-24.7 91.31,-0.1 212.28,-0.1 212.28,-24.7"></polygon>
<text text-anchor="middle" x="151.79" y="-8.2" font-family="Times,serif" font-size="14.00">Run/Test via ADB</text>
</g>
<!-- Install to Emulator&#45;&gt;Run/Test via ADB -->
<g id="edge13" class="edge">
<title>Install to Emulator-&gt;Run/Test via ADB</title>
<path fill="none" stroke="black" d="M151.79,-60.86C151.79,-53.46 151.79,-43.56 151.79,-34.72"></path>
<polygon fill="black" stroke="black" points="155.29,-34.7 151.79,-24.7 148.29,-34.7 155.29,-34.7"></polygon>
</g>
</g>
</svg>

</center>
</div>
<div class="paragraph">
<p>This flow considers plain apps without any dependencies. But real-world apps depend on libraries, which may have their own resources, manifests, and even native code. Android dependencies come with their own complexities:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Instead of a simple jar file that can be added to the classpath, Android libraries are distributed as AAR files, which are zip files containing compiled classes, resources, manifests, native libraries, Proguard files and more.</p>
</li>
<li>
<p>The AAR dependencies must be unpacked and each component processed separately in the appropriate step of the build pipeline.</p>
</li>
</ul>
</div>
<div class="paragraph">
<center>
<svg width="1058px" height="742px" viewBox="0.00 0.00 1058.08 742.40" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1.0 1.0) rotate(0.0) translate(4.0 738.4)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-738.4 1054.08,-738.4 1054.08,4 -4,4"></polygon>
<g id="clust1" class="cluster">
<title>cluster_aar</title>
<polygon fill="none" stroke="black" points="328.08,-539.2 328.08,-726.4 1042.08,-726.4 1042.08,-539.2 328.08,-539.2"></polygon>
<text text-anchor="middle" x="685.08" y="-709.8" font-family="Times,serif" font-size="14.00">Dependency (AARs)</text>
</g>
<!-- App Java/Kotlin Sources -->
<g id="node1" class="node">
<title>App Java/Kotlin Sources</title>
<polygon fill="white" stroke="black" points="839.05,-511.1 683.12,-511.1 683.12,-486.5 839.05,-486.5 839.05,-511.1"></polygon>
<text text-anchor="middle" x="761.08" y="-494.6" font-family="Times,serif" font-size="14.00">App Java/Kotlin Sources</text>
</g>
<!-- Compile (Java/Kotlin) -->
<g id="node2" class="node">
<title>Compile (Java/Kotlin)</title>
<polygon fill="white" stroke="black" points="831.67,-450.3 690.5,-450.3 690.5,-425.7 831.67,-425.7 831.67,-450.3"></polygon>
<text text-anchor="middle" x="761.08" y="-433.8" font-family="Times,serif" font-size="14.00">Compile (Java/Kotlin)</text>
</g>
<!-- App Java/Kotlin Sources&#45;&gt;Compile (Java/Kotlin) -->
<g id="edge1" class="edge">
<title>App Java/Kotlin Sources-&gt;Compile (Java/Kotlin)</title>
<path fill="none" stroke="black" d="M761.08,-486.46C761.08,-479.06 761.08,-469.16 761.08,-460.32"></path>
<polygon fill="black" stroke="black" points="764.58,-460.3 761.08,-450.3 757.58,-460.3 764.58,-460.3"></polygon>
</g>
<!-- Compiled Classes -->
<g id="node18" class="node">
<title>Compiled Classes</title>
<polygon fill="white" stroke="black" points="809.3,-389.5 692.87,-389.5 692.87,-364.9 809.3,-364.9 809.3,-389.5"></polygon>
<text text-anchor="middle" x="751.08" y="-373" font-family="Times,serif" font-size="14.00">Compiled Classes</text>
</g>
<!-- Compile (Java/Kotlin)&#45;&gt;Compiled Classes -->
<g id="edge16" class="edge">
<title>Compile (Java/Kotlin)-&gt;Compiled Classes</title>
<path fill="none" stroke="black" d="M759.16,-425.66C757.9,-418.26 756.21,-408.36 754.71,-399.52"></path>
<polygon fill="black" stroke="black" points="758.13,-398.77 753.01,-389.5 751.23,-399.95 758.13,-398.77"></polygon>
</g>
<!-- App Resources (res/) -->
<g id="node3" class="node">
<title>App Resources (res/)</title>
<polygon fill="white" stroke="black" points="134.25,-571.9 -0.08,-571.9 -0.08,-547.3 134.25,-547.3 134.25,-571.9"></polygon>
<text text-anchor="middle" x="67.08" y="-555.4" font-family="Times,serif" font-size="14.00">App Resources (res/)</text>
</g>
<!-- Compile App Resources (aapt2) -->
<g id="node4" class="node">
<title>Compile App Resources (aapt2)</title>
<polygon fill="white" stroke="black" points="232.09,-511.1 36.08,-511.1 36.08,-486.5 232.09,-486.5 232.09,-511.1"></polygon>
<text text-anchor="middle" x="134.08" y="-494.6" font-family="Times,serif" font-size="14.00">Compile App Resources (aapt2)</text>
</g>
<!-- App Resources (res/)&#45;&gt;Compile App Resources (aapt2) -->
<g id="edge2" class="edge">
<title>App Resources (res/)-&gt;Compile App Resources (aapt2)</title>
<path fill="none" stroke="black" d="M80,-547.26C89.46,-538.97 102.48,-527.53 113.38,-517.97"></path>
<polygon fill="black" stroke="black" points="116,-520.33 121.21,-511.1 111.38,-515.07 116,-520.33"></polygon>
</g>
<!-- Linked Resources -->
<g id="node17" class="node">
<title>Linked Resources</title>
<polygon fill="white" stroke="black" points="445.27,-450.3 328.9,-450.3 328.9,-425.7 445.27,-425.7 445.27,-450.3"></polygon>
<text text-anchor="middle" x="387.08" y="-433.8" font-family="Times,serif" font-size="14.00">Linked Resources</text>
</g>
<!-- Compile App Resources (aapt2)&#45;&gt;Linked Resources -->
<g id="edge12" class="edge">
<title>Compile App Resources (aapt2)-&gt;Linked Resources</title>
<path fill="none" stroke="black" d="M182.87,-486.46C224.52,-476.78 284.52,-462.84 328.71,-452.57"></path>
<polygon fill="black" stroke="black" points="329.5,-455.98 338.45,-450.3 327.92,-449.16 329.5,-455.98"></polygon>
</g>
<!-- App AndroidManifest.xml -->
<g id="node5" class="node">
<title>App AndroidManifest.xml</title>
<polygon fill="white" stroke="black" points="317.89,-571.9 152.28,-571.9 152.28,-547.3 317.89,-547.3 317.89,-571.9"></polygon>
<text text-anchor="middle" x="235.08" y="-555.4" font-family="Times,serif" font-size="14.00">App AndroidManifest.xml</text>
</g>
<!-- Manifest Merging -->
<g id="node6" class="node">
<title>Manifest Merging</title>
<polygon fill="white" stroke="black" points="380.06,-511.1 262.11,-511.1 262.11,-486.5 380.06,-486.5 380.06,-511.1"></polygon>
<text text-anchor="middle" x="321.08" y="-494.6" font-family="Times,serif" font-size="14.00">Manifest Merging</text>
</g>
<!-- App AndroidManifest.xml&#45;&gt;Manifest Merging -->
<g id="edge3" class="edge">
<title>App AndroidManifest.xml-&gt;Manifest Merging</title>
<path fill="none" stroke="black" d="M251.67,-547.26C264.28,-538.64 281.84,-526.63 296.14,-516.85"></path>
<polygon fill="black" stroke="black" points="298.27,-519.64 304.55,-511.1 294.32,-513.86 298.27,-519.64"></polygon>
</g>
<!-- Manifest Merging&#45;&gt;Linked Resources -->
<g id="edge15" class="edge">
<title>Manifest Merging-&gt;Linked Resources</title>
<path fill="none" stroke="black" d="M333.81,-486.46C343.12,-478.17 355.95,-466.73 366.69,-457.17"></path>
<polygon fill="black" stroke="black" points="369.26,-459.57 374.4,-450.3 364.6,-454.34 369.26,-459.57"></polygon>
</g>
<!-- App Proguard rules -->
<g id="node7" class="node">
<title>App Proguard rules</title>
<polygon fill="white" stroke="black" points="588.72,-450.3 463.45,-450.3 463.45,-425.7 588.72,-425.7 588.72,-450.3"></polygon>
<text text-anchor="middle" x="526.08" y="-433.8" font-family="Times,serif" font-size="14.00">App Proguard rules</text>
</g>
<!-- Proguard rules -->
<g id="node8" class="node">
<title>Proguard rules</title>
<polygon fill="white" stroke="black" points="601.11,-389.5 503.06,-389.5 503.06,-364.9 601.11,-364.9 601.11,-389.5"></polygon>
<text text-anchor="middle" x="552.08" y="-373" font-family="Times,serif" font-size="14.00">Proguard rules</text>
</g>
<!-- App Proguard rules&#45;&gt;Proguard rules -->
<g id="edge4" class="edge">
<title>App Proguard rules-&gt;Proguard rules</title>
<path fill="none" stroke="black" d="M531.1,-425.66C534.48,-418.02 539.04,-407.71 543.04,-398.65"></path>
<polygon fill="black" stroke="black" points="546.24,-400.06 547.09,-389.5 539.84,-397.23 546.24,-400.06"></polygon>
</g>
<!-- DEX (d8/r8) -->
<g id="node20" class="node">
<title>DEX (d8/r8)</title>
<polygon fill="white" stroke="black" points="698.72,-328.7 611.45,-328.7 611.45,-304.1 698.72,-304.1 698.72,-328.7"></polygon>
<text text-anchor="middle" x="655.08" y="-312.2" font-family="Times,serif" font-size="14.00">DEX (d8/r8)</text>
</g>
<!-- Proguard rules&#45;&gt;DEX (d8/r8) -->
<g id="edge25" class="edge">
<title>Proguard rules-&gt;DEX (d8/r8)</title>
<path fill="none" stroke="black" d="M571.94,-364.86C587.33,-356.08 608.88,-343.78 626.18,-333.9"></path>
<polygon fill="black" stroke="black" points="628.34,-336.7 635.29,-328.7 624.87,-330.62 628.34,-336.7"></polygon>
</g>
<!-- AAR Files -->
<g id="node9" class="node">
<title>AAR Files</title>
<polygon fill="white" stroke="black" points="709.36,-693.5 632.81,-693.5 632.81,-668.9 709.36,-668.9 709.36,-693.5"></polygon>
<text text-anchor="middle" x="671.08" y="-677" font-family="Times,serif" font-size="14.00">AAR Files</text>
</g>
<!-- Unpack AARs -->
<g id="node10" class="node">
<title>Unpack AARs</title>
<polygon fill="white" stroke="black" points="720.11,-632.7 622.05,-632.7 622.05,-608.1 720.11,-608.1 720.11,-632.7"></polygon>
<text text-anchor="middle" x="671.08" y="-616.2" font-family="Times,serif" font-size="14.00">Unpack AARs</text>
</g>
<!-- AAR Files&#45;&gt;Unpack AARs -->
<g id="edge5" class="edge">
<title>AAR Files-&gt;Unpack AARs</title>
<path fill="none" stroke="black" d="M671.08,-668.86C671.08,-661.46 671.08,-651.56 671.08,-642.72"></path>
<polygon fill="black" stroke="black" points="674.58,-642.7 671.08,-632.7 667.58,-642.7 674.58,-642.7"></polygon>
</g>
<!-- AAR classes.jar -->
<g id="node11" class="node">
<title>AAR classes.jar</title>
<polygon fill="white" stroke="black" points="854.27,-571.9 747.9,-571.9 747.9,-547.3 854.27,-547.3 854.27,-571.9"></polygon>
<text text-anchor="middle" x="801.08" y="-555.4" font-family="Times,serif" font-size="14.00">AAR classes.jar</text>
</g>
<!-- Unpack AARs&#45;&gt;AAR classes.jar -->
<g id="edge6" class="edge">
<title>Unpack AARs-&gt;AAR classes.jar</title>
<path fill="none" stroke="black" d="M696.15,-608.06C716.2,-598.99 744.53,-586.18 766.7,-576.15"></path>
<polygon fill="black" stroke="black" points="768.43,-579.21 776.1,-571.9 765.54,-572.83 768.43,-579.21"></polygon>
</g>
<!-- AAR res/ -->
<g id="node12" class="node">
<title>AAR res/</title>
<polygon fill="white" stroke="black" points="593.84,-571.9 524.32,-571.9 524.32,-547.3 593.84,-547.3 593.84,-571.9"></polygon>
<text text-anchor="middle" x="559.08" y="-555.4" font-family="Times,serif" font-size="14.00">AAR res/</text>
</g>
<!-- Unpack AARs&#45;&gt;AAR res/ -->
<g id="edge7" class="edge">
<title>Unpack AARs-&gt;AAR res/</title>
<path fill="none" stroke="black" d="M649.49,-608.06C632.45,-599.11 608.46,-586.52 589.48,-576.56"></path>
<polygon fill="black" stroke="black" points="591.09,-573.45 580.61,-571.9 587.84,-579.65 591.09,-573.45"></polygon>
</g>
<!-- AAR AndroidManifest.xml -->
<g id="node13" class="node">
<title>AAR AndroidManifest.xml</title>
<polygon fill="white" stroke="black" points="506.33,-571.9 335.84,-571.9 335.84,-547.3 506.33,-547.3 506.33,-571.9"></polygon>
<text text-anchor="middle" x="421.08" y="-555.4" font-family="Times,serif" font-size="14.00">AAR AndroidManifest.xml</text>
</g>
<!-- Unpack AARs&#45;&gt;AAR AndroidManifest.xml -->
<g id="edge8" class="edge">
<title>Unpack AARs-&gt;AAR AndroidManifest.xml</title>
<path fill="none" stroke="black" d="M622.88,-608.06C581.81,-598.4 522.68,-584.5 479.04,-574.23"></path>
<polygon fill="black" stroke="black" points="479.67,-570.78 469.14,-571.9 478.07,-577.6 479.67,-570.78"></polygon>
</g>
<!-- AAR proguard.txt -->
<g id="node14" class="node">
<title>AAR proguard.txt</title>
<polygon fill="white" stroke="black" points="729.95,-571.9 612.22,-571.9 612.22,-547.3 729.95,-547.3 729.95,-571.9"></polygon>
<text text-anchor="middle" x="671.08" y="-555.4" font-family="Times,serif" font-size="14.00">AAR proguard.txt</text>
</g>
<!-- Unpack AARs&#45;&gt;AAR proguard.txt -->
<g id="edge9" class="edge">
<title>Unpack AARs-&gt;AAR proguard.txt</title>
<path fill="none" stroke="black" d="M671.08,-608.06C671.08,-600.66 671.08,-590.76 671.08,-581.92"></path>
<polygon fill="black" stroke="black" points="674.58,-581.9 671.08,-571.9 667.58,-581.9 674.58,-581.9"></polygon>
</g>
<!-- AAR native .so (optional) -->
<g id="node15" class="node">
<title>AAR native .so (optional)</title>
<polygon fill="white" stroke="black" points="1034,-571.9 872.17,-571.9 872.17,-547.3 1034,-547.3 1034,-571.9"></polygon>
<text text-anchor="middle" x="953.08" y="-555.4" font-family="Times,serif" font-size="14.00">AAR native .so (optional)</text>
</g>
<!-- Unpack AARs&#45;&gt;AAR native .so (optional) -->
<g id="edge10" class="edge">
<title>Unpack AARs-&gt;AAR native .so (optional)</title>
<path fill="none" stroke="black" d="M720.2,-609.16C766.95,-599.41 837.57,-584.69 888.78,-574.01"></path>
<polygon fill="black" stroke="black" points="889.68,-577.4 898.75,-571.93 888.25,-570.54 889.68,-577.4"></polygon>
</g>
<!-- Compile Classpath -->
<g id="node19" class="node">
<title>Compile Classpath</title>
<polygon fill="white" stroke="black" points="979.24,-511.1 856.92,-511.1 856.92,-486.5 979.24,-486.5 979.24,-511.1"></polygon>
<text text-anchor="middle" x="918.08" y="-494.6" font-family="Times,serif" font-size="14.00">Compile Classpath</text>
</g>
<!-- AAR classes.jar&#45;&gt;Compile Classpath -->
<g id="edge17" class="edge">
<title>AAR classes.jar-&gt;Compile Classpath</title>
<path fill="none" stroke="black" d="M823.64,-547.26C841.53,-538.27 866.73,-525.61 886.6,-515.62"></path>
<polygon fill="black" stroke="black" points="888.23,-518.72 895.59,-511.1 885.09,-512.47 888.23,-518.72"></polygon>
</g>
<!-- AAR classes.jar&#45;&gt;DEX (d8/r8) -->
<g id="edge18" class="edge">
<title>AAR classes.jar-&gt;DEX (d8/r8)</title>
<path fill="none" stroke="black" d="M764.97,-547.28C729.51,-535.83 679.91,-518.78 674.08,-511.2 634.88,-460.23 643.45,-378 650.44,-339.11"></path>
<polygon fill="black" stroke="black" points="653.94,-339.42 652.41,-328.94 647.07,-338.08 653.94,-339.42"></polygon>
</g>
<!-- Compile Lib Resources (aapt2) -->
<g id="node16" class="node">
<title>Compile Lib Resources (aapt2)</title>
<polygon fill="white" stroke="black" points="588.92,-511.1 397.25,-511.1 397.25,-486.5 588.92,-486.5 588.92,-511.1"></polygon>
<text text-anchor="middle" x="493.08" y="-494.6" font-family="Times,serif" font-size="14.00">Compile Lib Resources (aapt2)</text>
</g>
<!-- AAR res/&#45;&gt;Compile Lib Resources (aapt2) -->
<g id="edge11" class="edge">
<title>AAR res/-&gt;Compile Lib Resources (aapt2)</title>
<path fill="none" stroke="black" d="M546.36,-547.26C537.05,-538.97 524.21,-527.53 513.48,-517.97"></path>
<polygon fill="black" stroke="black" points="515.57,-515.14 505.77,-511.1 510.91,-520.37 515.57,-515.14"></polygon>
</g>
<!-- AAR AndroidManifest.xml&#45;&gt;Manifest Merging -->
<g id="edge14" class="edge">
<title>AAR AndroidManifest.xml-&gt;Manifest Merging</title>
<path fill="none" stroke="black" d="M401.8,-547.26C386.86,-538.48 365.95,-526.18 349.15,-516.3"></path>
<polygon fill="black" stroke="black" points="350.7,-513.15 340.31,-511.1 347.15,-519.19 350.7,-513.15"></polygon>
</g>
<!-- AAR proguard.txt&#45;&gt;Proguard rules -->
<g id="edge23" class="edge">
<title>AAR proguard.txt-&gt;Proguard rules</title>
<path fill="none" stroke="black" d="M663.36,-547.11C657.1,-537.63 648.18,-523.74 641.08,-511.2 620.12,-474.15 622.75,-460.3 598.08,-425.6 590.76,-415.3 581.21,-405.08 572.71,-396.78"></path>
<polygon fill="black" stroke="black" points="574.97,-394.09 565.3,-389.75 570.15,-399.17 574.97,-394.09"></polygon>
</g>
<!-- Package APK -->
<g id="node21" class="node">
<title>Package APK</title>
<polygon fill="white" stroke="black" points="702.22,-267.9 607.95,-267.9 607.95,-243.3 702.22,-243.3 702.22,-267.9"></polygon>
<text text-anchor="middle" x="655.08" y="-251.4" font-family="Times,serif" font-size="14.00">Package APK</text>
</g>
<!-- AAR native .so (optional)&#45;&gt;Package APK -->
<g id="edge26" class="edge">
<title>AAR native .so (optional)-&gt;Package APK</title>
<path fill="none" stroke="black" d="M963.67,-546.95C971.44,-537.82 981.72,-524.49 988.08,-511.2 1002.42,-481.27 1007.08,-472.18 1007.08,-439 1007.08,-439 1007.08,-439 1007.08,-376.2 1007.08,-314.66 811.75,-278.44 712.11,-263.96"></path>
<polygon fill="black" stroke="black" points="712.59,-260.5 702.19,-262.55 711.6,-267.43 712.59,-260.5"></polygon>
</g>
<!-- Compile Lib Resources (aapt2)&#45;&gt;Linked Resources -->
<g id="edge13" class="edge">
<title>Compile Lib Resources (aapt2)-&gt;Linked Resources</title>
<path fill="none" stroke="black" d="M472.65,-486.46C456.66,-477.6 434.23,-465.15 416.34,-455.23"></path>
<polygon fill="black" stroke="black" points="417.9,-452.09 407.46,-450.3 414.51,-458.21 417.9,-452.09"></polygon>
</g>
<!-- Linked Resources&#45;&gt;Proguard rules -->
<g id="edge24" class="edge">
<title>Linked Resources-&gt;Proguard rules</title>
<path fill="none" stroke="black" d="M418.9,-425.66C445.03,-416.35 482.25,-403.09 510.7,-392.95"></path>
<polygon fill="black" stroke="black" points="512.12,-396.16 520.37,-389.5 509.77,-389.56 512.12,-396.16"></polygon>
</g>
<!-- Linked Resources&#45;&gt;Package APK -->
<g id="edge20" class="edge">
<title>Linked Resources-&gt;Package APK</title>
<path fill="none" stroke="black" d="M404.13,-425.49C425.24,-411.23 462.3,-386.2 494.08,-364.8 541.88,-332.61 597.71,-295.11 629.48,-273.78"></path>
<polygon fill="black" stroke="black" points="631.8,-276.44 638.16,-267.96 627.9,-270.63 631.8,-276.44"></polygon>
</g>
<!-- Compiled Classes&#45;&gt;DEX (d8/r8) -->
<g id="edge21" class="edge">
<title>Compiled Classes-&gt;DEX (d8/r8)</title>
<path fill="none" stroke="black" d="M732.57,-364.86C718.36,-356.16 698.52,-344.01 682.48,-334.18"></path>
<polygon fill="black" stroke="black" points="683.89,-330.94 673.54,-328.7 680.24,-336.91 683.89,-330.94"></polygon>
</g>
<!-- Compile Classpath&#45;&gt;Compile (Java/Kotlin) -->
<g id="edge19" class="edge">
<title>Compile Classpath-&gt;Compile (Java/Kotlin)</title>
<path fill="none" stroke="black" d="M887.81,-486.46C863.05,-477.19 827.84,-464 800.81,-453.88"></path>
<polygon fill="black" stroke="black" points="801.85,-450.53 791.26,-450.3 799.4,-457.09 801.85,-450.53"></polygon>
</g>
<!-- DEX (d8/r8)&#45;&gt;Package APK -->
<g id="edge22" class="edge">
<title>DEX (d8/r8)-&gt;Package APK</title>
<path fill="none" stroke="black" d="M655.08,-304.06C655.08,-296.66 655.08,-286.76 655.08,-277.92"></path>
<polygon fill="black" stroke="black" points="658.58,-277.9 655.08,-267.9 651.58,-277.9 658.58,-277.9"></polygon>
</g>
<!-- Code Shrinking (r8/Proguard) -->
<g id="node22" class="node">
<title>Code Shrinking (r8/Proguard)</title>
<polygon fill="white" stroke="black" points="747.05,-207.1 563.12,-207.1 563.12,-182.5 747.05,-182.5 747.05,-207.1"></polygon>
<text text-anchor="middle" x="655.08" y="-190.6" font-family="Times,serif" font-size="14.00">Code Shrinking (r8/Proguard)</text>
</g>
<!-- Package APK&#45;&gt;Code Shrinking (r8/Proguard) -->
<g id="edge27" class="edge">
<title>Package APK-&gt;Code Shrinking (r8/Proguard)</title>
<path fill="none" stroke="black" d="M655.08,-243.26C655.08,-235.86 655.08,-225.96 655.08,-217.12"></path>
<polygon fill="black" stroke="black" points="658.58,-217.1 655.08,-207.1 651.58,-217.1 658.58,-217.1"></polygon>
</g>
<!-- Sign APK -->
<g id="node23" class="node">
<title>Sign APK</title>
<polygon fill="white" stroke="black" points="691.75,-146.3 618.42,-146.3 618.42,-121.7 691.75,-121.7 691.75,-146.3"></polygon>
<text text-anchor="middle" x="655.08" y="-129.8" font-family="Times,serif" font-size="14.00">Sign APK</text>
</g>
<!-- Code Shrinking (r8/Proguard)&#45;&gt;Sign APK -->
<g id="edge28" class="edge">
<title>Code Shrinking (r8/Proguard)-&gt;Sign APK</title>
<path fill="none" stroke="black" d="M655.08,-182.46C655.08,-175.06 655.08,-165.16 655.08,-156.32"></path>
<polygon fill="black" stroke="black" points="658.58,-156.3 655.08,-146.3 651.58,-156.3 658.58,-156.3"></polygon>
</g>
<!-- Install to Emulator -->
<g id="node24" class="node">
<title>Install to Emulator</title>
<polygon fill="white" stroke="black" points="715.57,-85.5 594.6,-85.5 594.6,-60.9 715.57,-60.9 715.57,-85.5"></polygon>
<text text-anchor="middle" x="655.08" y="-69" font-family="Times,serif" font-size="14.00">Install to Emulator</text>
</g>
<!-- Sign APK&#45;&gt;Install to Emulator -->
<g id="edge29" class="edge">
<title>Sign APK-&gt;Install to Emulator</title>
<path fill="none" stroke="black" d="M655.08,-121.66C655.08,-114.26 655.08,-104.36 655.08,-95.52"></path>
<polygon fill="black" stroke="black" points="658.58,-95.5 655.08,-85.5 651.58,-95.5 658.58,-95.5"></polygon>
</g>
<!-- Run/Test via ADB -->
<g id="node25" class="node">
<title>Run/Test via ADB</title>
<polygon fill="white" stroke="black" points="715.57,-24.7 594.6,-24.7 594.6,-0.1 715.57,-0.1 715.57,-24.7"></polygon>
<text text-anchor="middle" x="655.08" y="-8.2" font-family="Times,serif" font-size="14.00">Run/Test via ADB</text>
</g>
<!-- Install to Emulator&#45;&gt;Run/Test via ADB -->
<g id="edge30" class="edge">
<title>Install to Emulator-&gt;Run/Test via ADB</title>
<path fill="none" stroke="black" d="M655.08,-60.86C655.08,-53.46 655.08,-43.56 655.08,-34.72"></path>
<polygon fill="black" stroke="black" points="658.58,-34.7 655.08,-24.7 651.58,-34.7 658.58,-34.7"></polygon>
</g>
</g>
</svg>

</center>
</div>
<div class="paragraph">
<p>The diagram above still doesn&rsquo;t tell the whole story! It shows a typical build flow for a basic Android app, but there are more features to consider:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Hilt/Dagger code generation (annotation processing)</p>
</li>
<li>
<p>Jetpack Compose code generation (Kotlin compiler plugin)</p>
</li>
<li>
<p>Instrumented tests (separate APK, own resources, manifests, dependencies)</p>
</li>
<li>
<p>Native code (NDK builds, CMake integration)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>We cover a lot of these architecture styles in various Android examples, based on <a href="../mill/android/java.html" class="xref page">Java</a>, <a href="../mill/android/kotlin.html" class="xref page">Kotlin</a> and third party integration examples covering <a href="../mill/android/compose-samples.html" class="xref page">Android Compose</a> and <a href="../mill/android/hilt-sample.html" class="xref page">Dependency Injection with Hilt</a>.</p>
</div>
<div class="paragraph">
<p>Endless tunnel sample app
<span class="image"><img src="_images/AndroidEndlessTunnelExample.png" alt="An Android app built with Mill using native code" width="showing a 3D tunnel effect." /></span></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_try_it_out"><a class="anchor" href="#_try_it_out"></a>Try it out</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Mill&rsquo;s Android support is still young, but it already covers the full build pipeline: resource compilation, manifest merging, packaging, signing, running, and even testing on emulators.</p>
</div>
<div class="paragraph">
<p>What makes this different from Gradle are control and transparency: every build step is a visible Mill task, easy to run on its own, inspect, check its dependencies, or override, without needing any extra/third party plugins. That means you can debug problems faster, adapt the pipeline to your project&rsquo;s needs, and extend it without fighting opaque built-in or plugin logic.</p>
</div>
<div class="paragraph">
<p>If you&rsquo;re curious, the best way to appreciate this is to try it yourself:</p>
</div>
<div class="paragraph">
<p>Get the <code>architecture-samples</code> containing the Todo App.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; git clone git@github.com:android/architecture-samples.git
&gt; cd architecture-samples</code></pre>
</div>
</div>
<div class="paragraph">
<p>Install mill</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; curl -L https://repo1.maven.org/maven2/com/lihaoyi/mill-dist/1.0.5/mill-dist-1.0.5-mill.sh -o mill
&gt; chmod +x mill
&gt; echo &quot;//| mill-version: 1.0.5&quot; &gt; build.mill
&gt; ./mill version</code></pre>
</div>
</div>
<div class="paragraph">
<p>Configure the mill build</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; curl https://raw.githubusercontent.com/com-lihaoyi/mill/bef0194f3eecb4c7938f07e0cfcdf8d741a04468/example/thirdparty/androidtodo/build.mill &gt;&gt; build.mill</code></pre>
</div>
</div>
<div class="paragraph">
<p>Start the emulator and run the app</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; ./mill show app.createAndroidVirtualDevice
&gt; ./mill show app.startAndroidEmulator
&gt; ./mill show app.androidInstall
&gt; ./mill show app.androidRun --activity com.example.android.architecture.blueprints.todoapp.TodoActivity</code></pre>
</div>
</div>
<div class="paragraph">
<p>The Android Todo App built with Mill
<span class="image"><img src="_images/AndroidTodoExample.png" alt="The Todo app built with Mill" width="showing a list of tasks and a button to add new tasks." /></span></p>
</div>
<div class="paragraph">
<p>Run the instrumented tests and watch the app being tested inside the emulator:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">&gt; ./mill app.androidTest</code></pre>
</div>
</div>
<div class="paragraph">
<p><span class="image"><img src="_images/androidtodo_test.gif" alt="Android Test running inside an emulator" width="showing the Todo app being tested automatically." /></span></p>
</div>
<div class="paragraph">
<p>Letâs say you want to know how the apk is built. First, you can check the plan of <code>androidApk</code>, i.e. which
tasks it depends on:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./mill plan app.androidApk
[1/1] plan
androidSdkModule0.sdkPath
androidSdkModule0.buildToolsVersion
androidSdkModule0.platformsVersion
androidSdkModule0.remoteReposInfo
androidSdkModule0.installAndroidSdkComponents
androidSdkModule0.buildToolsPath
androidSdkModule0.apksignerPath
androidSdkModule0.zipalignPath
app.mandatoryMvnDeps.super.javalib.JavaModule
app.kotlinVersion</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can use this to visualise the relationships between these tasks and how they feed each other and ultimately the <code>androidApk</code> task:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-console hljs" data-lang="console">$ ./mill visualizePlan app.androidApk
[3/3] visualizePlan
[
  &quot;.../architecture-samples/out/visualizePlan.dest/out.dot&quot;,
  &quot;.../architecture-samples/out/visualizePlan.dest/out.json&quot;,
  &quot;.../architecture-samples/out/visualizePlan.dest/out.png&quot;,
  &quot;.../architecture-samples/out/visualizePlan.dest/out.svg&quot;,
  &quot;.../architecture-samples/out/visualizePlan.dest/out.txt&quot;
]
[3/3] ============================== visualizePlan app.androidApk ============================== 2s</code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also check the code of each task and what it does exactly inside your IDE:
<span class="image"><img src="_images/AndroidIDEExplore.png" alt="Exploring the Mill Android build tasks in an IDE" width="showing the source code for the androidApk task." /></span></p>
</div>
<div class="paragraph">
<p>In addition, due to <a href="12-direct-style-build-tool.html#_direct_style_builds" class="xref page">Millâs direct style</a>, you can reason whatâs going on with relative ease.</p>
</div>
<div class="sect2">
<h3 id="_example_tweak_the_build_in_your_build_mill"><a class="anchor" href="#_example_tweak_the_build_in_your_build_mill"></a>Example: tweak the build in your <code>build.mill</code></h3>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-scala hljs" data-lang="scala">import mill._
import mill.androidlib._

object app extends AndroidAppModule {
  def androidApplicationNamespace = &quot;com.example.app&quot;
  def androidApplicationId = &quot;com.example.app&quot;
  def androidCompileSdk = 35

  // Add extra files into the APK
  override def androidPackageableExtraFiles = super.androidPackageableExtraFiles() ++
    Seq(
      AndroidPackageableExtraFile(
          PathRef(moduleDir / &quot;assets/about.txt&quot;),
          os.RelPath(&quot;assets/about.txt&quot;)
      )
    )

}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_further_exploration"><a class="anchor" href="#_further_exploration"></a>Further Exploration</h3>
<div class="paragraph">
<p>You may also inspect <a href="../mill/android/android-initial-setup.html" class="xref page">the getting started docs</a> to find out more.</p>
</div>
<div class="paragraph">
<p>We&rsquo;d love feedback from the Android community, whether it&rsquo;s bug reports, feature requests, or success stories. If you&rsquo;ve ever wished Android builds felt less like a black box, Mill is worth a look.</p>
</div>
</div>
</div>
</div>
<nav class="pagination">
  <span class="prev"><a href="16-zero-setup.html">Zero-Setup Java Build Tooling via Mill Bootstrap Scripts</a></span>
  <span class="next"><a href="14-bash-zsh-completion.html">Writing Your Own Simple Tab-Completions for Bash and Zsh</a></span>
</nav>
</article>
  </div>
</main>
</div>
<script id="site-script" src="../_/js/site.js" data-ui-root-path="../_"></script>
<script async="async" src="../_/js/vendor/highlight.js"></script>
<script src="../_/js/vendor/lunr.js"></script>
<script src="../_/js/search-ui.js" id="search-ui-script" data-site-root-path=".." data-snippet-length="100" data-stylesheet="../_/css/search.css"></script>
<script async="async" src="../search-index.js"></script>
  
</body></html>